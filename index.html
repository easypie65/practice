<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤‘3 ì‚¼ê°ë¹„ ì´ë³µìŠµ - ë§ì¶¤í˜• ë¬¸ì œì€í–‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .progress-section {
            padding: 20px 30px;
            background: #f8f9ff;
            border-bottom: 1px solid #e0e6ff;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e6ff;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            text-align: center;
        }

        .stat {
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-width: 120px;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .main-content {
            display: flex;
            min-height: 600px;
        }

        .sidebar {
            width: 300px;
            background: #f8f9ff;
            padding: 30px;
            border-right: 1px solid #e0e6ff;
        }

        .topic-list {
            list-style: none;
        }

        .topic-item {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .topic-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .topic-item.active {
            border-color: #4facfe;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .topic-item.completed::after {
            content: 'âœ“';
            position: absolute;
            right: 15px;
            top: 15px;
            color: #4caf50;
            font-weight: bold;
            font-size: 1.2em;
        }

        .content-area {
            flex: 1;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .problem-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            max-width: 600px;
            width: 100%;
            margin-bottom: 30px;
            display: none;
        }

        .problem-card.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .problem-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .problem-image {
            text-align: center;
            margin: 20px 0;
        }

        .problem-text {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 25px;
            color: #555;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #e0e6ff;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1em;
        }

        .option:hover {
            border-color: #4facfe;
            background: #f8f9ff;
        }

        .option.selected {
            border-color: #4facfe;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .option.correct {
            border-color: #4caf50;
            background: #e8f5e8;
            color: #2e7d32;
        }

        .option.wrong {
            border-color: #f44336;
            background: #ffebee;
            color: #c62828;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-secondary {
            background: #f0f2f5;
            color: #666;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            display: none;
        }

        .feedback.correct {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            color: #2e7d32;
        }

        .feedback.wrong {
            background: #ffebee;
            border: 2px solid #f44336;
            color: #c62828;
        }

        .explanation {
            margin-top: 15px;
            font-size: 1em;
            line-height: 1.5;
        }

        .reference-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .reference-title {
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
        }

        .formulas {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
        }

        .formula {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .welcome-screen {
            text-align: center;
        }

        .welcome-title {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 20px;
        }

        .welcome-text {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .start-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(79, 172, 254, 0.4);
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”º ì‚¼ê°ë¹„ ë§ˆìŠ¤í„°</h1>
            <p>ì¤‘í•™êµ 3í•™ë…„ ì‚¼ê°ë¹„ ì´ ë³µìŠµ - ë§ì¶¤í˜• ë¬¸ì œì€í–‰</p>
        </div>

        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-number" id="totalSolved">0</div>
                    <div>í•´ê²°í•œ ë¬¸ì œ</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="correctRate">0%</div>
                    <div>ì •ë‹µë¥ </div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="currentStreak">0</div>
                    <div>ì—°ì† ì •ë‹µ</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <div class="reference-card">
                    <div class="reference-title">ğŸ“ ì‚¼ê°ë¹„ ê³µì‹</div>
                    <div class="formulas">
                        <div class="formula">sin Î¸ = ëŒ€ë³€/ë¹—ë³€</div>
                        <div class="formula">cos Î¸ = ì¸ë³€/ë¹—ë³€</div>
                        <div class="formula">tan Î¸ = ëŒ€ë³€/ì¸ë³€</div>
                    </div>
                </div>

                <!-- ì§„í–‰ìƒí™© ê´€ë¦¬ ë²„íŠ¼ -->
                <div style="background: #f8f9ff; padding: 15px; border-radius: 15px; margin-bottom: 20px; text-align: center;">
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 10px;">ì§„í–‰ìƒí™© ê´€ë¦¬</div>
                    <button class="btn btn-secondary" onclick="resetProgress()" style="padding: 8px 16px; font-size: 0.9em;">ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘</button>
                </div>
                
                <ul class="topic-list">
                    <li class="topic-item" data-topic="basic">
                        <strong>ê¸°ë³¸ ê°œë…</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ì‚¼ê°ë¹„ì˜ ì •ì˜ì™€ ê¸°ë³¸ ê°œë…</div>
                    </li>
                    <li class="topic-item" data-topic="calculation">
                        <strong>ì‚¼ê°ë¹„ ê³„ì‚°</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ì£¼ì–´ì§„ ì¡°ê±´ìœ¼ë¡œ ì‚¼ê°ë¹„ êµ¬í•˜ê¸°</div>
                    </li>
                    <li class="topic-item" data-topic="special">
                        <strong>íŠ¹ìˆ˜ê°</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">30Â°, 45Â°, 60Â° ì‚¼ê°ë¹„</div>
                    </li>
                    <li class="topic-item" data-topic="application">
                        <strong>í™œìš© ë¬¸ì œ</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ì‹¤ìƒí™œ ë¬¸ì œ í•´ê²°í•˜ê¸°</div>
                    </li>
                    <li class="topic-item" data-topic="mixed">
                        <strong>ì¢…í•© ë¬¸ì œ</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ëª¨ë“  ë‚´ìš©ì„ ì¢…í•©í•œ ë¬¸ì œ</div>
                    </li>
                </ul>
            </div>

            <div class="content-area">
                <div id="welcomeScreen" class="welcome-screen">
                    <h2 class="welcome-title">ì‚¼ê°ë¹„ ì´ë³µìŠµì„ ì‹œì‘í•´ë³´ì„¸ìš”! ğŸš€</h2>
                    <p class="welcome-text">
                        ì™¼ìª½ì—ì„œ í•™ìŠµí•˜ê³  ì‹¶ì€ ì£¼ì œë¥¼ ì„ íƒí•˜ë©´<br>
                        ë§ì¶¤í˜• ë¬¸ì œë“¤ì´ ì°¨ë¡€ëŒ€ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.<br>
                        ê° ë¬¸ì œë§ˆë‹¤ ìì„¸í•œ í•´ì„¤ê³¼ í•¨ê»˜ ì‹¤ë ¥ì„ í‚¤ì›Œë³´ì„¸ìš”!
                    </p>
                    <button class="start-btn" data-topic="basic">ê¸°ë³¸ ê°œë…ë¶€í„° ì‹œì‘í•˜ê¸°</button>
                </div>

                <div id="problemCard" class="problem-card">
                    <h3 class="problem-title" id="problemTitle">ë¬¸ì œ</h3>
                    <div class="problem-image" id="problemImage"></div>
                    <div class="problem-text" id="problemText">ë¬¸ì œ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
                    <div class="options" id="optionsContainer"></div>
                    <div class="buttons">
                        <button class="btn btn-secondary" id="hintBtn">ğŸ’¡ íŒíŠ¸</button>
                        <button class="btn btn-primary" id="checkBtn" disabled>ì •ë‹µ í™•ì¸</button>
                        <button class="btn btn-primary" id="nextBtn" style="display: none;">ë‹¤ìŒ ë¬¸ì œ</button>
                    </div>
                    <div class="feedback" id="feedback">
                        <div id="feedbackText"></div>
                        <div class="explanation" id="explanation"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentTopic = '';
        let currentProblemIndex = 0;
        let selectedAnswer = null;
        let stats = {
            totalSolved: 0,
            correctAnswers: 0,
            currentStreak: 0
        };

        // ë¬¸ì œ ë³€í˜• í•¨ìˆ˜ë“¤
        function getRandomNumbers() {
            const sets = [
                {hypotenuse: "10", opposite: "6", adjacent: "8"},
                {hypotenuse: "13", opposite: "5", adjacent: "12"},
                {hypotenuse: "15", opposite: "9", adjacent: "12"},
                {hypotenuse: "17", opposite: "8", adjacent: "15"},
                {hypotenuse: "25", opposite: "15", adjacent: "20"},
                {hypotenuse: "26", opposite: "10", adjacent: "24"}
            ];
            return sets[Math.floor(Math.random() * sets.length)];
        }

        function getRandomFraction() {
            const fractions = [
                {sin: "3/5", cos: "4/5", h: "5", o: "3", a: "4"},
                {sin: "5/13", cos: "12/13", h: "13", o: "5", a: "12"},
                {sin: "8/17", cos: "15/17", h: "17", o: "8", a: "15"},
                {sin: "7/25", cos: "24/25", h: "25", o: "7", a: "24"},
                {sin: "9/15", cos: "12/15", h: "15", o: "9", a: "12"}
            ];
            return fractions[Math.floor(Math.random() * fractions.length)];
        }

        function getRandomBuilding() {
            const buildings = [
                {height: "20", distance: "50", answer: "2/5"},
                {height: "15", distance: "36", answer: "5/12"},
                {height: "24", distance: "32", answer: "3/4"},
                {height: "18", distance: "24", answer: "3/4"},
                {height: "30", distance: "40", answer: "3/4"}
            ];
            return buildings[Math.floor(Math.random() * buildings.length)];
        }

        // ìº¡ì²˜ ë° ì—…ë¡œë“œ í•¨ìˆ˜
        function captureAndUpload() {
            // í™”ë©´ ìº¡ì²˜ (html2canvas ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”)
            if (typeof html2canvas !== 'undefined') {
                html2canvas(document.body).then(canvas => {
                    // ìº”ë²„ìŠ¤ë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜
                    const imageData = canvas.toDataURL('image/png');
                    
                    // ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
                    const link = document.createElement('a');
                    link.download = `ì‚¼ê°ë¹„ë§ˆìŠ¤í„°_100%ë‹¬ì„±_${new Date().toLocaleDateString()}.png`;
                    link.href = imageData;
                    link.click();
                    
                    // ì—…ë¡œë“œ ì•ˆë‚´
                    showUploadGuide();
                });
            } else {
                // html2canvasê°€ ì—†ìœ¼ë©´ ìŠ¤í¬ë¦°ìƒ· ì•ˆë‚´
                showScreenshotGuide();
            }
        }

        function showUploadGuide() {
            const uploadModal = document.createElement('div');
            uploadModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            uploadModal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 20px; max-width: 500px; text-align: center;">
                    <h2 style="color: #27ae60; margin-bottom: 20px;">ğŸ‰ 100% ë‹¬ì„± ì¶•í•˜í•©ë‹ˆë‹¤!</h2>
                    <p style="margin-bottom: 20px; line-height: 1.6;">
                        í™”ë©´ì´ ìº¡ì²˜ë˜ì–´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!<br>
                        <strong>3í•™ë…„ 6ë°˜</strong> í•™ìƒë“¤ì€ ì•„ë˜ ë§í¬ì—ì„œ ì¸ì¦ìƒ·ì„ ì˜¬ë ¤ì£¼ì„¸ìš”!
                    </p>
                    <div style="background: #f8f9ff; padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <strong>ì—…ë¡œë“œ ë§í¬:</strong><br>
                        <a href="https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638" 
                           target="_blank" 
                           style="color: #4facfe; word-break: break-all;">
                            https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638
                        </a>
                    </div>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="window.open('https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638', '_blank')" 
                                style="background: #27ae60; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: bold;">
                            ì—…ë¡œë“œí•˜ëŸ¬ ê°€ê¸°
                        </button>
                        <button onclick="this.closest('div').parentElement.remove()" 
                                style="background: #95a5a6; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer;">
                            ë‹«ê¸°
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(uploadModal);
        }

        function showScreenshotGuide() {
            const screenshotModal = document.createElement('div');
            screenshotModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            screenshotModal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 20px; max-width: 500px; text-align: center;">
                    <h2 style="color: #27ae60; margin-bottom: 20px;">ğŸ‰ 100% ë‹¬ì„± ì¶•í•˜í•©ë‹ˆë‹¤!</h2>
                    <p style="margin-bottom: 20px; line-height: 1.6;">
                        ì´ í™”ë©´ì„ ìŠ¤í¬ë¦°ìƒ·ìœ¼ë¡œ ìº¡ì²˜í•´ì£¼ì„¸ìš”!<br>
                        <small style="color: #666;">(Windows: Win+Shift+S, Mac: Cmd+Shift+4)</small>
                    </p>
                    <p style="margin-bottom: 20px;">
                        <strong>3í•™ë…„ 6ë°˜</strong> í•™ìƒë“¤ì€ ì•„ë˜ ë§í¬ì—ì„œ ì¸ì¦ìƒ·ì„ ì˜¬ë ¤ì£¼ì„¸ìš”!
                    </p>
                    <div style="background: #f8f9ff; padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <strong>ì—…ë¡œë“œ ë§í¬:</strong><br>
                        <a href="https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638" 
                           target="_blank" 
                           style="color: #4facfe; word-break: break-all;">
                            https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638
                        </a>
                    </div>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="window.open('https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638', '_blank')" 
                                style="background: #27ae60; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: bold;">
                            ì—…ë¡œë“œí•˜ëŸ¬ ê°€ê¸°
                        </button>
                        <button onclick="this.closest('div').parentElement.remove()" 
                                style="background: #95a5a6; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer;">
                            ë‹«ê¸°
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(screenshotModal);
        }
        function saveProgress() {
            const progressData = {
                stats: stats,
                currentTopic: currentTopic,
                currentProblemIndex: currentProblemIndex,
                completedTopics: []
            };
            
            // ì™„ë£Œëœ ì£¼ì œë“¤ ì €ì¥
            document.querySelectorAll('.topic-item.completed').forEach(item => {
                progressData.completedTopics.push(item.getAttribute('data-topic'));
            });
            
            localStorage.setItem('trigonometry_progress', JSON.stringify(progressData));
        }

        function loadProgress() {
            const saved = localStorage.getItem('trigonometry_progress');
            if (saved) {
                const progressData = JSON.parse(saved);
                
                // í†µê³„ ë³µì›
                stats = progressData.stats || {
                    totalSolved: 0,
                    correctAnswers: 0,
                    currentStreak: 0
                };
                
                // í˜„ì¬ ì§„í–‰ ìƒí™© ë³µì›
                currentTopic = progressData.currentTopic || '';
                currentProblemIndex = progressData.currentProblemIndex || 0;
                
                // ì™„ë£Œëœ ì£¼ì œë“¤ í‘œì‹œ ë³µì›
                if (progressData.completedTopics) {
                    progressData.completedTopics.forEach(topic => {
                        const topicItem = document.querySelector(`[data-topic="${topic}"]`);
                        if (topicItem) {
                            topicItem.classList.add('completed');
                        }
                    });
                }
                
                return true;
            }
            return false;
        }

        function resetProgress() {
            localStorage.removeItem('trigonometry_progress');
            
            // í†µê³„ ì´ˆê¸°í™”
            stats = {
                totalSolved: 0,
                correctAnswers: 0,
                currentStreak: 0
            };
            
            // í˜„ì¬ ìƒíƒœ ì´ˆê¸°í™”
            currentTopic = '';
            currentProblemIndex = 0;
            
            // ì™„ë£Œ í‘œì‹œ ì œê±°
            document.querySelectorAll('.topic-item').forEach(item => {
                item.classList.remove('completed');
                item.classList.remove('active');
            });
            
            // í™˜ì˜ í™”ë©´ìœ¼ë¡œ ë³µê·€
            const welcomeScreen = document.getElementById('welcomeScreen');
            const problemCard = document.getElementById('problemCard');
            
            if (welcomeScreen) welcomeScreen.style.display = 'block';
            if (problemCard) problemCard.style.display = 'none';
            
            updateStats();
        }
        function generateProblem(baseProblem, variation = 0) {
            const newProblem = JSON.parse(JSON.stringify(baseProblem)); // ê¹Šì€ ë³µì‚¬
            
            if (baseProblem.title.includes("ê¸°ë³¸ ê°œë…")) {
                const numbers = getRandomNumbers();
                newProblem.image = createTriangleImage(numbers.hypotenuse, numbers.opposite, numbers.adjacent, "Î¸");
                
                if (baseProblem.title.includes("1")) { // sin ë¬¸ì œ
                    const sinValue = (parseFloat(numbers.opposite) / parseFloat(numbers.hypotenuse)).toFixed(2);
                    newProblem.text = `ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ A = Î¸ì¼ ë•Œ, sin Î¸ì˜ ê°’ì€?`;
                    newProblem.options = [sinValue, "0.8", "0.75", "1.2"];
                    newProblem.correct = 0;
                    newProblem.explanation = `ê° Aì—ì„œ ë³´ë©´ ëŒ€ë³€ì€ BC = ${numbers.opposite}, ë¹—ë³€ì€ AC = ${numbers.hypotenuse}ì´ë¯€ë¡œ\nsin Î¸ = sin A = ëŒ€ë³€/ë¹—ë³€ = ${numbers.opposite}/${numbers.hypotenuse} = ${sinValue}ì…ë‹ˆë‹¤.`;
                } else if (baseProblem.title.includes("2")) { // cos ë¬¸ì œ
                    const cosValue = (parseFloat(numbers.adjacent) / parseFloat(numbers.hypotenuse)).toFixed(2);
                    newProblem.text = `ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ A = Î¸ì¼ ë•Œ, cos Î¸ì˜ ê°’ì€?`;
                    newProblem.options = ["0.6", cosValue, "1.25", "0.75"];
                    newProblem.correct = 1;
                    newProblem.explanation = `ê° Aì—ì„œ ë³´ë©´ ì¸ë³€ì€ AB = ${numbers.adjacent}, ë¹—ë³€ì€ AC = ${numbers.hypotenuse}ì´ë¯€ë¡œ\ncos Î¸ = cos A = ì¸ë³€/ë¹—ë³€ = ${numbers.adjacent}/${numbers.hypotenuse} = ${cosValue}ì…ë‹ˆë‹¤.`;
                } else if (baseProblem.title.includes("3")) { // tan ë¬¸ì œ
                    const tanValue = (parseFloat(numbers.opposite) / parseFloat(numbers.adjacent)).toFixed(2);
                    newProblem.text = `ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ A = Î¸ì¼ ë•Œ, tan Î¸ì˜ ê°’ì€?`;
                    newProblem.options = [tanValue, "1.33", "0.6", "0.8"];
                    newProblem.correct = 0;
                    newProblem.explanation = `ê° Aì—ì„œ ë³´ë©´ ëŒ€ë³€ì€ BC = ${numbers.opposite}, ì¸ë³€ì€ AB = ${numbers.adjacent}ì´ë¯€ë¡œ\ntan Î¸ = tan A = ëŒ€ë³€/ì¸ë³€ = ${numbers.opposite}/${numbers.adjacent} = ${tanValue}ì…ë‹ˆë‹¤.`;
                }
            } else if (baseProblem.title.includes("ê³„ì‚° ë¬¸ì œ 1")) {
                const frac = getRandomFraction();
                newProblem.text = `ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ B = 90Â°ì´ê³ , âˆ A = Î¸, sin Î¸ = ${frac.sin}ì¼ ë•Œ, cos Î¸ì˜ ê°’ì€?`;
                newProblem.options = [frac.cos, "3/4", "5/4", "5/3"];
                newProblem.correct = 0;
                newProblem.explanation = `sin Î¸ = ${frac.sin}ì´ë¯€ë¡œ ëŒ€ë³€:ë¹—ë³€ = ${frac.o}:${frac.h}ì…ë‹ˆë‹¤.\ní”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬ë¡œ ì¸ë³€ì„ êµ¬í•˜ë©´: ì¸ë³€ = âˆš(${frac.h}Â² - ${frac.o}Â²) = ${frac.a}\në”°ë¼ì„œ cos Î¸ = ì¸ë³€/ë¹—ë³€ = ${frac.a}/${frac.h} = ${frac.cos}ì…ë‹ˆë‹¤.`;
            } else if (baseProblem.title.includes("í™œìš© ë¬¸ì œ 1")) {
                const building = getRandomBuilding();
                newProblem.text = `ë†’ì´ ${building.height}mì¸ ê±´ë¬¼ì„ ${building.distance}m ê±°ë¦¬ì—ì„œ ì˜¬ë ¤ë‹¤ë³¸ ê°ì„ Î¸ë¼ í•  ë•Œ, tan Î¸ëŠ”?`;
                newProblem.options = [building.answer, "5/2", "3/4", "4/3"];
                newProblem.correct = 0;
                newProblem.explanation = `tan Î¸ = ëŒ€ë³€/ì¸ë³€ = ê±´ë¬¼ë†’ì´/ê±°ë¦¬ = ${building.height}/${building.distance} = ${building.answer}ì…ë‹ˆë‹¤.`;
                newProblem.image = `<div style="text-align: center;"><svg width="250" height="140" viewBox="0 0 250 140"><rect x="180" y="40" width="15" height="80" fill="#4facfe"/><line x1="20" y1="120" x2="220" y2="120" stroke="#333" stroke-width="2"/><line x1="50" y1="120" x2="185" y2="40" stroke="#e74c3c" stroke-width="2" stroke-dasharray="3,3"/><text x="115" y="135" text-anchor="middle" font-size="12" fill="#333">${building.distance}m</text><text x="205" y="85" font-size="12" fill="#333">${building.height}m</text><text x="60" y="110" font-size="12" fill="#e74c3c" font-weight="bold">Î¸</text></svg></div>`;
            }
            
            return newProblem;
        }
        function createTriangleImage(hypotenuse, opposite, adjacent, angle) {
            return `
                <svg width="250" height="180" viewBox="0 0 250 180">
                    <polygon points="30,140 170,140 170,50" fill="rgba(79, 172, 254, 0.1)" stroke="#4facfe" stroke-width="3"/>
                    <rect x="162" y="132" width="8" height="8" fill="none" stroke="#666" stroke-width="1"/>
                    <path d="M 40,140 A 10,10 0 0,0 47,133" fill="none" stroke="#e74c3c" stroke-width="2"/>
                    <text x="50" y="132" font-size="16" fill="#e74c3c" font-weight="bold">${angle}</text>
                    <text x="100" y="155" text-anchor="middle" font-size="14" fill="#2c3e50" font-weight="bold">ì¸ë³€ = ${adjacent}</text>
                    <text x="185" y="95" text-anchor="middle" font-size="14" fill="#2c3e50" font-weight="bold">ëŒ€ë³€ = ${opposite}</text>
                    <text x="95" y="90" text-anchor="middle" font-size="14" fill="#2c3e50" font-weight="bold">ë¹—ë³€ = ${hypotenuse}</text>
                    <circle cx="30" cy="140" r="3" fill="#e74c3c"/>
                    <circle cx="170" cy="140" r="3" fill="#2c3e50"/>
                    <circle cx="170" cy="50" r="3" fill="#2c3e50"/>
                    <text x="25" y="155" font-size="16" fill="#e74c3c" font-weight="bold">A</text>
                    <text x="175" y="155" font-size="16" fill="#2c3e50" font-weight="bold">B</text>
                    <text x="175" y="45" font-size="16" fill="#2c3e50" font-weight="bold">C</text>
                    <text x="150" y="155" font-size="12" fill="#666">90Â°</text>
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c"/>
                        </marker>
                    </defs>
                    <path d="M 45,125 Q 55,120 45,115" fill="none" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrowhead)"/>
                </svg>
            `;
        }

        // ë¬¸ì œ ë°ì´í„°
        const problemSets = {
            basic: [
                {
                    title: "ê¸°ë³¸ ê°œë… 1",
                    text: "ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ A = Î¸ì¼ ë•Œ, sin Î¸ì˜ ê°’ì€?",
                    image: createTriangleImage("10", "6", "8", "Î¸"),
                    options: ["0.6", "0.8", "0.75", "1.2"],
                    correct: 0,
                    explanation: "ê° Aì—ì„œ ë³´ë©´ ëŒ€ë³€ì€ BC = 6, ë¹—ë³€ì€ AC = 10ì´ë¯€ë¡œ\nsin Î¸ = sin A = ëŒ€ë³€/ë¹—ë³€ = 6/10 = 0.6ì…ë‹ˆë‹¤.",
                    hint: "ê° A(Î¸)ì—ì„œ ëŒ€ë³€ì€ ë§ì€í¸ ë³€ BCì´ê³ , ë¹—ë³€ì€ ACì…ë‹ˆë‹¤. sin Î¸ = ëŒ€ë³€/ë¹—ë³€ì´ì—ìš”."
                },
                {
                    title: "ê¸°ë³¸ ê°œë… 2",
                    text: "ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ A = Î¸ì¼ ë•Œ, cos Î¸ì˜ ê°’ì€?",
                    image: createTriangleImage("10", "6", "8", "Î¸"),
                    options: ["0.6", "0.8", "1.25", "0.75"],
                    correct: 1,
                    explanation: "ê° Aì—ì„œ ë³´ë©´ ì¸ë³€ì€ AB = 8, ë¹—ë³€ì€ AC = 10ì´ë¯€ë¡œ\ncos Î¸ = cos A = ì¸ë³€/ë¹—ë³€ = 8/10 = 0.8ì…ë‹ˆë‹¤.",
                    hint: "ê° A(Î¸)ì—ì„œ ì¸ë³€ì€ ì¸ì ‘í•œ ë³€ ABì´ê³ , ë¹—ë³€ì€ ACì…ë‹ˆë‹¤. cos Î¸ = ì¸ë³€/ë¹—ë³€ì´ì—ìš”."
                },
                {
                    title: "ê¸°ë³¸ ê°œë… 3",
                    text: "ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ A = Î¸ì¼ ë•Œ, tan Î¸ì˜ ê°’ì€?",
                    image: createTriangleImage("10", "6", "8", "Î¸"),
                    options: ["0.75", "1.33", "0.6", "0.8"],
                    correct: 0,
                    explanation: "ê° Aì—ì„œ ë³´ë©´ ëŒ€ë³€ì€ BC = 6, ì¸ë³€ì€ AB = 8ì´ë¯€ë¡œ\ntan Î¸ = tan A = ëŒ€ë³€/ì¸ë³€ = 6/8 = 0.75ì…ë‹ˆë‹¤.",
                    hint: "ê° A(Î¸)ì—ì„œ ëŒ€ë³€ì€ BC, ì¸ë³€ì€ ABì…ë‹ˆë‹¤. tan Î¸ = ëŒ€ë³€/ì¸ë³€ì´ì—ìš”."
                }
            ],
            calculation: [
                {
                    title: "ê³„ì‚° ë¬¸ì œ 1",
                    text: "ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ B = 90Â°ì´ê³ , âˆ A = Î¸, sin Î¸ = 3/5ì¼ ë•Œ, cos Î¸ì˜ ê°’ì€?",
                    image: "",
                    options: ["4/5", "3/4", "5/4", "5/3"],
                    correct: 0,
                    explanation: "sin Î¸ = 3/5ì´ë¯€ë¡œ ëŒ€ë³€:ë¹—ë³€ = 3:5ì…ë‹ˆë‹¤.\ní”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬ë¡œ ì¸ë³€ì„ êµ¬í•˜ë©´: ì¸ë³€ = âˆš(5Â² - 3Â²) = âˆš(25 - 9) = âˆš16 = 4\në”°ë¼ì„œ cos Î¸ = ì¸ë³€/ë¹—ë³€ = 4/5ì…ë‹ˆë‹¤.",
                    hint: "sinÂ²Î¸ + cosÂ²Î¸ = 1 ë˜ëŠ” í”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬ë¥¼ ì´ìš©í•´ë³´ì„¸ìš”."
                },
                {
                    title: "ê³„ì‚° ë¬¸ì œ 2",
                    text: "ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ C = 90Â°ì´ê³ , âˆ A = Î², AB = 13, BC = 5ì¼ ë•Œ, tan Î²ëŠ”?",
                    image: "",
                    options: ["5/12", "12/5", "5/13", "12/13"],
                    correct: 0,
                    explanation: "âˆ C = 90Â°ì´ë¯€ë¡œ ABê°€ ë¹—ë³€ì…ë‹ˆë‹¤.\ní”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬ë¡œ ACë¥¼ êµ¬í•˜ë©´: AC = âˆš(ABÂ² - BCÂ²) = âˆš(13Â² - 5Â²) = âˆš(169 - 25) = 12\nê° A(Î²)ì—ì„œ ë³´ë©´ ëŒ€ë³€ì€ BC = 5, ì¸ë³€ì€ AC = 12ì´ë¯€ë¡œ\ntan Î² = ëŒ€ë³€/ì¸ë³€ = 5/12ì…ë‹ˆë‹¤.",
                    hint: "âˆ C = 90Â°ì´ë¯€ë¡œ ABê°€ ë¹—ë³€ì´ì—ìš”. ê° Î²ì—ì„œ ëŒ€ë³€ê³¼ ì¸ë³€ì„ ì°¾ì•„ë³´ì„¸ìš”."
                }
            ],
            special: [
                {
                    title: "íŠ¹ìˆ˜ê° 1",
                    text: "sin 30Â°ì˜ ê°’ì€?",
                    image: "",
                    options: ["1/2", "âˆš2/2", "âˆš3/2", "1"],
                    correct: 0,
                    explanation: "30-60-90 ì‚¼ê°í˜•ì—ì„œ ë³€ì˜ ë¹„ëŠ” 1:âˆš3:2ì…ë‹ˆë‹¤.\n30Â° ê°ì—ì„œ ëŒ€ë³€:ë¹—ë³€ = 1:2ì´ë¯€ë¡œ sin 30Â° = 1/2ì…ë‹ˆë‹¤.",
                    hint: "30-60-90 ì§ê°ì‚¼ê°í˜•ì„ ê·¸ë ¤ë³´ì„¸ìš”. ë³€ì˜ ë¹„ëŠ” 1:âˆš3:2ì…ë‹ˆë‹¤."
                },
                {
                    title: "íŠ¹ìˆ˜ê° 2",
                    text: "cos 45Â°ì˜ ê°’ì€?",
                    image: "",
                    options: ["1/2", "âˆš2/2", "âˆš3/2", "1"],
                    correct: 1,
                    explanation: "45-45-90 ì‚¼ê°í˜•ì—ì„œ ë³€ì˜ ë¹„ëŠ” 1:1:âˆš2ì…ë‹ˆë‹¤.\n45Â° ê°ì—ì„œ ì¸ë³€:ë¹—ë³€ = 1:âˆš2ì´ë¯€ë¡œ cos 45Â° = 1/âˆš2 = âˆš2/2ì…ë‹ˆë‹¤.",
                    hint: "45-45-90 ì§ê°ì‚¼ê°í˜•ì€ ì´ë“±ë³€ì§ê°ì‚¼ê°í˜•ì´ì—ìš”. ë³€ì˜ ë¹„ëŠ” 1:1:âˆš2ì…ë‹ˆë‹¤."
                },
                {
                    title: "íŠ¹ìˆ˜ê° 3",
                    text: "tan 60Â°ì˜ ê°’ì€?",
                    image: "",
                    options: ["1/2", "âˆš2", "âˆš3", "1/âˆš3"],
                    correct: 2,
                    explanation: "30-60-90 ì‚¼ê°í˜•ì—ì„œ ë³€ì˜ ë¹„ëŠ” 1:âˆš3:2ì…ë‹ˆë‹¤.\n60Â° ê°ì—ì„œ ëŒ€ë³€:ì¸ë³€ = âˆš3:1ì´ë¯€ë¡œ tan 60Â° = âˆš3ì…ë‹ˆë‹¤.",
                    hint: "60Â° ê°ì—ì„œ ëŒ€ë³€ê³¼ ì¸ë³€ì˜ ë¹„ë¥¼ ìƒê°í•´ë³´ì„¸ìš”."
                }
            ],
            application: [
                {
                    title: "í™œìš© ë¬¸ì œ 1",
                    text: "ë†’ì´ 20mì¸ ê±´ë¬¼ì„ 50m ê±°ë¦¬ì—ì„œ ì˜¬ë ¤ë‹¤ë³¸ ê°ì„ Î¸ë¼ í•  ë•Œ, tan Î¸ëŠ”?",
                    image: '<div style="text-align: center;"><svg width="250" height="140" viewBox="0 0 250 140"><rect x="180" y="40" width="15" height="80" fill="#4facfe"/><line x1="20" y1="120" x2="220" y2="120" stroke="#333" stroke-width="2"/><line x1="50" y1="120" x2="185" y2="40" stroke="#e74c3c" stroke-width="2" stroke-dasharray="3,3"/><text x="115" y="135" text-anchor="middle" font-size="12" fill="#333">50m</text><text x="205" y="85" font-size="12" fill="#333">20m</text><text x="60" y="110" font-size="12" fill="#e74c3c" font-weight="bold">Î¸</text></svg></div>',
                    options: ["2/5", "5/2", "3/4", "4/3"],
                    correct: 0,
                    explanation: "tan Î¸ = ëŒ€ë³€/ì¸ë³€ = ê±´ë¬¼ë†’ì´/ê±°ë¦¬ = 20/50 = 2/5ì…ë‹ˆë‹¤.",
                    hint: "ê±´ë¬¼ì˜ ë†’ì´ê°€ ëŒ€ë³€, ê±´ë¬¼ë¡œë¶€í„°ì˜ ê±°ë¦¬ê°€ ì¸ë³€ì´ì—ìš”."
                }
            ],
            mixed: [
                {
                    title: "ì¢…í•© ë¬¸ì œ 1",
                    text: "ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ B = 90Â°ì´ê³ , ACê°€ ë¹—ë³€ì´ë©° AC = 13, AB = 5ì¼ ë•Œ, sin Aì˜ ê°’ì€?",
                    image: "",
                    options: ["5/13", "12/13", "5/12", "12/5"],
                    correct: 1,
                    explanation: "âˆ B = 90Â°ì´ë¯€ë¡œ ACê°€ ë¹—ë³€ì…ë‹ˆë‹¤.\ní”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬ë¡œ BCë¥¼ êµ¬í•˜ë©´: BC = âˆš(ACÂ² - ABÂ²) = âˆš(13Â² - 5Â²) = âˆš(169 - 25) = âˆš144 = 12\nê° Aì—ì„œ ë³´ë©´ ëŒ€ë³€ì€ BC = 12, ë¹—ë³€ì€ AC = 13ì´ë¯€ë¡œ\nsin A = ëŒ€ë³€/ë¹—ë³€ = 12/13ì…ë‹ˆë‹¤.",
                    hint: "âˆ B = 90Â°ì´ë¯€ë¡œ ACê°€ ë¹—ë³€ì´ì—ìš”. í”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬ë¡œ ë¨¼ì € ë‚˜ë¨¸ì§€ í•œ ë³€ì„ êµ¬í•´ë³´ì„¸ìš”."
                },
                {
                    title: "ì¢…í•© ë¬¸ì œ 2",
                    text: "ì§ê°ì‚¼ê°í˜• ABCì—ì„œ âˆ C = 90Â°ì´ê³ , âˆ A = Î±, AB = 25, BC = 15ì¼ ë•Œ, cos Î± + sin Î±ì˜ ê°’ì€?",
                    image: "",
                    options: ["1", "7/5", "4/5", "3/5"],
                    correct: 1,
                    explanation: "âˆ C = 90Â°ì´ë¯€ë¡œ ABê°€ ë¹—ë³€ì…ë‹ˆë‹¤.\ní”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬ë¡œ ACë¥¼ êµ¬í•˜ë©´: AC = âˆš(ABÂ² - BCÂ²) = âˆš(25Â² - 15Â²) = âˆš(625 - 225) = âˆš400 = 20\nê° A(Î±)ì—ì„œ:\nâ€¢ ëŒ€ë³€ = BC = 15, ì¸ë³€ = AC = 20, ë¹—ë³€ = AB = 25\nâ€¢ sin Î± = 15/25 = 3/5\nâ€¢ cos Î± = 20/25 = 4/5\në”°ë¼ì„œ cos Î± + sin Î± = 4/5 + 3/5 = 7/5ì…ë‹ˆë‹¤.",
                    hint: "ê°ê°ì˜ ì‚¼ê°ë¹„ë¥¼ êµ¬í•œ í›„ ë”í•´ë³´ì„¸ìš”. âˆ C = 90Â°ì„ì„ ìŠì§€ ë§ˆì„¸ìš”."
                },
                {
                    title: "ì¢…í•© ë¬¸ì œ 3",
                    text: "íŠ¹ìˆ˜ê°ì„ ì´ìš©í•˜ì—¬ sin 30Â° + cos 60Â°ì˜ ê°’ì€?",
                    image: "",
                    options: ["1", "âˆš3/2", "1/2", "âˆš3"],
                    correct: 0,
                    explanation: "íŠ¹ìˆ˜ê°ì˜ ê°’ì„ ì´ìš©í•˜ë©´:\nsin 30Â° = 1/2ì´ê³ , cos 60Â° = 1/2ì´ë¯€ë¡œ\nsin 30Â° + cos 60Â° = 1/2 + 1/2 = 1ì…ë‹ˆë‹¤.",
                    hint: "íŠ¹ìˆ˜ê°ì˜ ì‚¼ê°ë¹„ ê°’ì„ ê¸°ì–µí•´ë³´ì„¸ìš”. sin 30Â° = cos 60Â° = 1/2ì…ë‹ˆë‹¤."
                }
            ]
        };

        // ì£¼ì œ ì„ íƒ í•¨ìˆ˜
        function selectTopic(topic) {
            console.log('selectTopic í˜¸ì¶œë¨:', topic); // ë””ë²„ê·¸ìš©
            
            document.querySelectorAll('.topic-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[data-topic="${topic}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }

            currentTopic = topic;
            currentProblemIndex = 0;
            
            const welcomeScreen = document.getElementById('welcomeScreen');
            const problemCard = document.getElementById('problemCard');
            
            if (welcomeScreen) welcomeScreen.style.display = 'none';
            if (problemCard) {
                problemCard.style.display = 'block';
                
                // ê¸°ë³¸ ë¬¸ì œ êµ¬ì¡°ë¡œ ì´ˆê¸°í™”
                problemCard.innerHTML = `
                    <h3 class="problem-title" id="problemTitle">ë¬¸ì œ</h3>
                    <div class="problem-image" id="problemImage"></div>
                    <div class="problem-text" id="problemText">ë¬¸ì œ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
                    <div class="options" id="optionsContainer"></div>
                    <div class="buttons">
                        <button class="btn btn-secondary" id="hintBtn">ğŸ’¡ íŒíŠ¸</button>
                        <button class="btn btn-primary" id="checkBtn" disabled>ì •ë‹µ í™•ì¸</button>
                        <button class="btn btn-primary" id="nextBtn" style="display: none;">ë‹¤ìŒ ë¬¸ì œ</button>
                    </div>
                    <div class="feedback" id="feedback">
                        <div id="feedbackText"></div>
                        <div class="explanation" id="explanation"></div>
                    </div>
                `;
                
                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë‹¤ì‹œ ì—°ê²°
                const hintBtn = document.getElementById('hintBtn');
                const checkBtn = document.getElementById('checkBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                if (hintBtn) hintBtn.addEventListener('click', showHint);
                if (checkBtn) checkBtn.addEventListener('click', checkAnswer);
                if (nextBtn) nextBtn.addEventListener('click', nextProblem);
            }
            
            showProblem();
        }

        // ë¬¸ì œ í‘œì‹œ í•¨ìˆ˜
        function showProblem() {
            const problems = problemSets[currentTopic];
            if (!problems || currentProblemIndex >= problems.length) {
                showTopicComplete();
                return;
            }

            const problem = problems[currentProblemIndex];
            
            const titleElement = document.getElementById('problemTitle');
            const textElement = document.getElementById('problemText');
            const imageElement = document.getElementById('problemImage');
            const optionsContainer = document.getElementById('optionsContainer');
            const feedbackElement = document.getElementById('feedback');
            
            if (titleElement) titleElement.textContent = problem.title;
            if (textElement) textElement.textContent = problem.text;
            if (imageElement) imageElement.innerHTML = problem.image || '';
            
            if (optionsContainer) {
                optionsContainer.innerHTML = '';
                
                problem.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    optionDiv.textContent = option;
                    optionDiv.onclick = () => selectOption(index);
                    optionsContainer.appendChild(optionDiv);
                });
            }
            
            resetButtons();
            selectedAnswer = null;
            if (feedbackElement) feedbackElement.style.display = 'none';
        }

        // ì„ íƒì§€ ì„ íƒ
        function selectOption(index) {
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            const options = document.querySelectorAll('.option');
            if (options[index]) {
                options[index].classList.add('selected');
                selectedAnswer = index;
                
                const checkBtn = document.getElementById('checkBtn');
                if (checkBtn) {
                    checkBtn.disabled = false;
                }
            }
        }

        // íŒíŠ¸ í‘œì‹œ
        function showHint() {
            const problem = problemSets[currentTopic][currentProblemIndex];
            alert('ğŸ’¡ íŒíŠ¸: ' + problem.hint);
        }

        // ì •ë‹µ í™•ì¸
        function checkAnswer() {
            if (selectedAnswer === null) return;
            
            const problem = problemSets[currentTopic][currentProblemIndex];
            const isCorrect = selectedAnswer === problem.correct;
            
            stats.totalSolved++;
            if (isCorrect) {
                stats.correctAnswers++;
                stats.currentStreak++;
            } else {
                stats.currentStreak = 0;
            }
            
            document.querySelectorAll('.option').forEach((opt, index) => {
                if (index === problem.correct) {
                    opt.classList.add('correct');
                } else if (index === selectedAnswer && !isCorrect) {
                    opt.classList.add('wrong');
                }
            });
            
            const feedback = document.getElementById('feedback');
            const feedbackText = document.getElementById('feedbackText');
            const explanation = document.getElementById('explanation');
            const checkBtn = document.getElementById('checkBtn');
            const nextBtn = document.getElementById('nextBtn');
            const hintBtn = document.getElementById('hintBtn');
            
            if (feedback) {
                feedback.className = `feedback ${isCorrect ? 'correct' : 'wrong'}`;
                feedback.style.display = 'block';
            }
            
            if (feedbackText) {
                feedbackText.textContent = isCorrect ? 'ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!' : 'âŒ í‹€ë ¸ìŠµë‹ˆë‹¤.';
            }
            
            if (explanation) {
                explanation.textContent = problem.explanation;
            }
            
            if (checkBtn) checkBtn.style.display = 'none';
            if (nextBtn) nextBtn.style.display = 'inline-block';
            if (hintBtn) hintBtn.style.display = 'none';
            
            updateStats();
        }

        // ë‹¤ìŒ ë¬¸ì œ
        function nextProblem() {
            currentProblemIndex++;
            showProblem();
        }

        // ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”
        function resetButtons() {
            const checkBtn = document.getElementById('checkBtn');
            const nextBtn = document.getElementById('nextBtn');
            const hintBtn = document.getElementById('hintBtn');
            
            if (checkBtn) {
                checkBtn.style.display = 'inline-block';
                checkBtn.disabled = true;
            }
            
            if (nextBtn) {
                nextBtn.style.display = 'none';
            }
            
            if (hintBtn) {
                hintBtn.style.display = 'inline-block';
            }
        }

        // í†µê³„ ì—…ë°ì´íŠ¸ (ì§„í–‰ìƒí™© ì €ì¥ ì¶”ê°€)
        function updateStats() {
            const totalSolvedElement = document.getElementById('totalSolved');
            const correctRateElement = document.getElementById('correctRate');
            const currentStreakElement = document.getElementById('currentStreak');
            const progressFillElement = document.getElementById('progressFill');
            
            if (totalSolvedElement) {
                totalSolvedElement.textContent = stats.totalSolved;
            }
            
            if (correctRateElement) {
                correctRateElement.textContent = 
                    stats.totalSolved > 0 ? Math.round((stats.correctAnswers / stats.totalSolved) * 100) + '%' : '0%';
            }
            
            if (currentStreakElement) {
                currentStreakElement.textContent = stats.currentStreak;
            }
            
            if (progressFillElement) {
                const totalProblems = Object.values(problemSets).reduce((sum, problems) => sum + problems.length, 0);
                const progress = (stats.totalSolved / totalProblems) * 100;
                progressFillElement.style.width = progress + '%';
            }
            
            // ì§„í–‰ ìƒí™© ìë™ ì €ì¥
            saveProgress();
        }

        // ì£¼ì œ ì™„ë£Œ í‘œì‹œ
        function showTopicComplete() {
            const correctRate = stats.totalSolved > 0 ? Math.round((stats.correctAnswers / stats.totalSolved) * 100) : 0;
            
            // ëª¨ë“  ì£¼ì œì— 66% ê¸°ì¤€ ì ìš©
            if (correctRate < 66) {
                const retryButtonText = currentTopic === 'basic' ? 'ê¸°ë³¸ ê°œë… ë‹¤ì‹œ í’€ê¸°' : 
                                      currentTopic === 'calculation' ? 'ì‚¼ê°ë¹„ ê³„ì‚° ë‹¤ì‹œ í’€ê¸°' :
                                      currentTopic === 'special' ? 'íŠ¹ìˆ˜ê° ë‹¤ì‹œ í’€ê¸°' :
                                      currentTopic === 'application' ? 'í™œìš© ë¬¸ì œ ë‹¤ì‹œ í’€ê¸°' :
                                      'ì¢…í•© ë¬¸ì œ ë‹¤ì‹œ í’€ê¸°';
                
                document.getElementById('problemCard').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h2 style="color: #e74c3c; margin-bottom: 20px;">ğŸ”„ ì¬ë„ì „ì´ í•„ìš”í•´ìš”!</h2>
                        <p style="font-size: 1.2em; margin-bottom: 20px;">
                            í˜„ì¬ ì •ë‹µë¥ : <strong style="color: #e74c3c;">${correctRate}%</strong>
                        </p>
                        <p style="font-size: 1.1em; margin-bottom: 30px; line-height: 1.6;">
                            ì´ ì£¼ì œëŠ” 66% ì´ìƒì˜ ì •ë‹µë¥ ì´ í•„ìš”í•©ë‹ˆë‹¤.<br>
                            ë” íƒ„íƒ„í•œ ì´í•´ë¥¼ ìœ„í•´ ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”! ğŸ’ª<br>
                            ë°˜ë³µ í•™ìŠµìœ¼ë¡œ ë” ì¢‹ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆì–´ìš”!
                        </p>
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button class="btn btn-primary" onclick="retryCurrentTopic()">${retryButtonText}</button>
                            <button class="btn btn-secondary" onclick="goToWelcome()">ì£¼ì œ ì„ íƒí•˜ê¸°</button>
                        </div>
                    </div>
                `;
            } else {
                // 66% ì´ìƒ ë‹¬ì„± ì‹œ ë‹¤ìŒ ì£¼ì œ ì¶”ì²œ
                let nextTopicButtons = '';
                let congratsMessage = '';
                
                // ëª¨ë“  ì£¼ì œ ì™„ë£Œ í™•ì¸
                const allTopicsCompleted = checkAllTopicsCompleted();
                
                if (currentTopic === 'mixed' && allTopicsCompleted && correctRate >= 66) {
                    // ëª¨ë“  ì£¼ì œ ì™„ë£Œ + ì¢…í•©ë¬¸ì œê¹Œì§€ ì™„ë£Œ = 100% ë‹¬ì„±!
                    document.getElementById('problemCard').innerHTML = `
                        <div style="text-align: center; padding: 40px;">
                            <h1 style="color: #27ae60; margin-bottom: 20px; font-size: 3em;">ğŸ†</h1>
                            <h2 style="color: #27ae60; margin-bottom: 20px;">ì‚¼ê°ë¹„ ë§ˆìŠ¤í„° ë‹¬ì„±!</h2>
                            <p style="font-size: 1.3em; margin-bottom: 20px; color: #27ae60; font-weight: bold;">
                                ğŸ‰ 100% ì™„ì „ ì •ë³µ! ğŸ‰
                            </p>
                            <p style="font-size: 1.1em; margin-bottom: 30px; line-height: 1.6;">
                                ëª¨ë“  ì£¼ì œë¥¼ ì™„ë£Œí•˜ê³  ì¢…í•©ë¬¸ì œê¹Œì§€ ì„±ê³µí–ˆìŠµë‹ˆë‹¤!<br>
                                ë‹¹ì‹ ì€ ì§„ì •í•œ <strong>ì‚¼ê°ë¹„ ë§ˆìŠ¤í„°</strong>ì…ë‹ˆë‹¤! ğŸ‘‘
                            </p>
                            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; margin: 20px 0;">
                                <h3 style="margin-bottom: 15px;">ğŸ« 3í•™ë…„ 6ë°˜ í•™ìƒë“¤</h3>
                                <p style="margin-bottom: 15px;">100% ë‹¬ì„± ì¸ì¦ìƒ·ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”!</p>
                            </div>
                            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                                <button class="btn btn-primary" onclick="captureAndUpload()" style="background: linear-gradient(135deg, #27ae60, #2ecc71); font-size: 1.1em; padding: 15px 25px;">
                                    ğŸ“¸ ì¸ì¦ìƒ· ìº¡ì²˜ & ì—…ë¡œë“œ
                                </button>
                                <button class="btn btn-secondary" onclick="resetProgress()">ìƒˆë¡œìš´ ë„ì „ ì‹œì‘</button>
                                <button class="btn btn-secondary" onclick="goToWelcome()">ì£¼ì œ ì„ íƒí•˜ê¸°</button>
                            </div>
                        </div>
                    `;
                    return;
                }
                
                switch(currentTopic) {
                    case 'basic':
                        congratsMessage = 'ê¸°ë³¸ ê°œë…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ì´ì œ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°ˆ ì¤€ë¹„ê°€ ë˜ì—ˆì–´ìš”!';
                        nextTopicButtons = `
                            <button class="btn btn-primary" onclick="goToCalculation()">ì‚¼ê°ë¹„ ê³„ì‚°</button>
                            <button class="btn btn-primary" onclick="goToSpecial()">íŠ¹ìˆ˜ê°</button>
                        `;
                        break;
                    case 'calculation':
                        congratsMessage = 'ì‚¼ê°ë¹„ ê³„ì‚°ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ë‹¤ë¥¸ ì˜ì—­ë„ ë„ì „í•´ë³´ì„¸ìš”!';
                        nextTopicButtons = `
                            <button class="btn btn-primary" onclick="goToSpecial()">íŠ¹ìˆ˜ê°</button>
                            <button class="btn btn-primary" onclick="goToApplication()">í™œìš© ë¬¸ì œ</button>
                        `;
                        break;
                    case 'special':
                        congratsMessage = 'íŠ¹ìˆ˜ê°ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ì‹¤ìƒí™œ ì‘ìš© ë¬¸ì œì— ë„ì „í•´ë³´ì„¸ìš”!';
                        nextTopicButtons = `
                            <button class="btn btn-primary" onclick="goToApplication()">í™œìš© ë¬¸ì œ</button>
                            <button class="btn btn-primary" onclick="goToMixed()">ì¢…í•© ë¬¸ì œ</button>
                        `;
                        break;
                    case 'application':
                        congratsMessage = 'í™œìš© ë¬¸ì œë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ë§ˆì§€ë§‰ ë‹¨ê³„ì— ë„ì „í•´ë³´ì„¸ìš”!';
                        nextTopicButtons = `
                            <button class="btn btn-primary" onclick="goToMixed()">ì¢…í•© ë¬¸ì œ</button>
                        `;
                        break;
                    case 'mixed':
                        congratsMessage = 'ì¢…í•© ë¬¸ì œë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ë‹¤ë¥¸ ì£¼ì œë“¤ë„ ì™„ë£Œí•´ì„œ 100%ë¥¼ ë‹¬ì„±í•´ë³´ì„¸ìš”!';
                        nextTopicButtons = '';
                        break;
                }
                
                document.getElementById('problemCard').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h2 style="color: #27ae60; margin-bottom: 20px;">ğŸ‰ ì£¼ì œ ì™„ë£Œ!</h2>
                        <p style="font-size: 1.2em; margin-bottom: 20px;">
                            í˜„ì¬ ì •ë‹µë¥ : <strong style="color: #27ae60;">${correctRate}%</strong>
                        </p>
                        <p style="font-size: 1.1em; margin-bottom: 30px; line-height: 1.6;">
                            ${congratsMessage}
                        </p>
                        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                            ${nextTopicButtons}
                            <button class="btn btn-secondary" onclick="goToWelcome()">ì£¼ì œ ì„ íƒí•˜ê¸°</button>
                        </div>
                    </div>
                `;
            }
            
            const completedItem = document.querySelector(`[data-topic="${currentTopic}"]`);
            if (completedItem && correctRate >= 66) {
                completedItem.classList.add('completed');
            }
        }

        // ëª¨ë“  ì£¼ì œ ì™„ë£Œ í™•ì¸
        function checkAllTopicsCompleted() {
            const topics = ['basic', 'calculation', 'special', 'application', 'mixed'];
            return topics.every(topic => {
                const topicItem = document.querySelector(`[data-topic="${topic}"]`);
                return topicItem && topicItem.classList.contains('completed');
            });
        }

        // ê° ì£¼ì œë¡œ ì´ë™í•˜ëŠ” ê°œë³„ í•¨ìˆ˜ë“¤
        function goToCalculation() {
            console.log('goToCalculation í˜¸ì¶œë¨'); // ë””ë²„ê·¸ìš©
            selectTopic('calculation');
        }

        function goToSpecial() {
            console.log('goToSpecial í˜¸ì¶œë¨'); // ë””ë²„ê·¸ìš©
            selectTopic('special');
        }

        function goToApplication() {
            console.log('goToApplication í˜¸ì¶œë¨'); // ë””ë²„ê·¸ìš©
            selectTopic('application');
        }

        function goToMixed() {
            console.log('goToMixed í˜¸ì¶œë¨'); // ë””ë²„ê·¸ìš©
            selectTopic('mixed');
        }

        // í˜„ì¬ ì£¼ì œ ì¬ë„ì „ í•¨ìˆ˜
        function retryCurrentTopic() {
            console.log('retryCurrentTopic ì‹¤í–‰, currentTopic:', currentTopic); // ë””ë²„ê·¸ìš©
            
            // í†µê³„ ì´ˆê¸°í™”
            stats.totalSolved = 0;
            stats.correctAnswers = 0;
            stats.currentStreak = 0;
            
            // ë¬¸ì œë¥¼ ë³€í˜•í•˜ì—¬ ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œ ìƒì„±
            const originalProblems = problemSets[currentTopic];
            const newProblems = originalProblems.map((problem, index) => {
                return generateProblem(problem, Math.floor(Math.random() * 3) + 1);
            });
            
            // ë³€í˜•ëœ ë¬¸ì œë¡œ êµì²´
            problemSets[currentTopic] = newProblems;
            
            // í˜„ì¬ ì£¼ì œ ë‹¤ì‹œ ì‹œì‘
            currentProblemIndex = 0;
            
            // ëª¨ë“  ì£¼ì œ í•­ëª©ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.topic-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // í˜„ì¬ ì£¼ì œ í•­ëª©ì„ í™œì„±í™”
            const currentItem = document.querySelector(`[data-topic="${currentTopic}"]`);
            if (currentItem) {
                currentItem.classList.remove('completed');
                currentItem.classList.add('active');
            }
            
            // í™˜ì˜ í™”ë©´ ìˆ¨ê¸°ê³  ë¬¸ì œ ì¹´ë“œ í‘œì‹œ
            const welcomeScreen = document.getElementById('welcomeScreen');
            const problemCard = document.getElementById('problemCard');
            
            if (welcomeScreen) welcomeScreen.style.display = 'none';
            if (problemCard) {
                problemCard.style.display = 'block';
                // ê¸°ì¡´ ì™„ë£Œ ë©”ì‹œì§€ ë‚´ìš©ì„ ì´ˆê¸°í™”
                problemCard.innerHTML = `
                    <h3 class="problem-title" id="problemTitle">ë¬¸ì œ</h3>
                    <div class="problem-image" id="problemImage"></div>
                    <div class="problem-text" id="problemText">ë¬¸ì œ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
                    <div class="options" id="optionsContainer"></div>
                    <div class="buttons">
                        <button class="btn btn-secondary" id="hintBtn">ğŸ’¡ íŒíŠ¸</button>
                        <button class="btn btn-primary" id="checkBtn" disabled>ì •ë‹µ í™•ì¸</button>
                        <button class="btn btn-primary" id="nextBtn" style="display: none;">ë‹¤ìŒ ë¬¸ì œ</button>
                    </div>
                    <div class="feedback" id="feedback">
                        <div id="feedbackText"></div>
                        <div class="explanation" id="explanation"></div>
                    </div>
                `;
                
                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë‹¤ì‹œ ì—°ê²°
                const hintBtn = document.getElementById('hintBtn');
                const checkBtn = document.getElementById('checkBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                if (hintBtn) hintBtn.addEventListener('click', showHint);
                if (checkBtn) checkBtn.addEventListener('click', checkAnswer);
                if (nextBtn) nextBtn.addEventListener('click', nextProblem);
            }
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            updateStats();
            
            // ì²« ë¬¸ì œ í‘œì‹œ
            showProblem();
        }

        // í™˜ì˜ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
        function goToWelcome() {
            document.getElementById('problemCard').style.display = 'none';
            document.getElementById('welcomeScreen').style.display = 'block';
            document.querySelectorAll('.topic-item').forEach(item => {
                item.classList.remove('active');
            });
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            // ì €ì¥ëœ ì§„í–‰ìƒí™© ë¡œë“œ
            const hasProgress = loadProgress();
            
            // ì£¼ì œ í•­ëª© í´ë¦­ ì´ë²¤íŠ¸
            document.querySelectorAll('.topic-item').forEach(item => {
                item.addEventListener('click', function() {
                    const topic = this.getAttribute('data-topic');
                    selectTopic(topic);
                });
            });

            // ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            document.querySelector('.start-btn').addEventListener('click', function() {
                const topic = this.getAttribute('data-topic');
                selectTopic(topic);
            });

            // íŒíŠ¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            const hintBtn = document.getElementById('hintBtn');
            if (hintBtn) hintBtn.addEventListener('click', showHint);

            // ì •ë‹µ í™•ì¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            const checkBtn = document.getElementById('checkBtn');
            if (checkBtn) checkBtn.addEventListener('click', checkAnswer);

            // ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) nextBtn.addEventListener('click', nextProblem);

            // ì´ˆê¸° í†µê³„ í‘œì‹œ
            updateStats();
            
            // ì§„í–‰ìƒí™©ì´ ìˆê³  í˜„ì¬ ì£¼ì œê°€ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´ ë³µì›
            if (hasProgress && currentTopic) {
                const activeItem = document.querySelector(`[data-topic="${currentTopic}"]`);
                if (activeItem) {
                    activeItem.classList.add('active');
                }
                
                // ì§„í–‰ì¤‘ì¸ ì£¼ì œê°€ ìˆìœ¼ë©´ ë¬¸ì œ í™”ë©´ìœ¼ë¡œ
                if (currentTopic && currentProblemIndex >= 0) {
                    const welcomeScreen = document.getElementById('welcomeScreen');
                    const problemCard = document.getElementById('problemCard');
                    
                    if (welcomeScreen) welcomeScreen.style.display = 'none';
                    if (problemCard) problemCard.style.display = 'block';
                    
                    // ê¸°ë³¸ êµ¬ì¡° ì„¤ì •
                    problemCard.innerHTML = `
                        <h3 class="problem-title" id="problemTitle">ë¬¸ì œ</h3>
                        <div class="problem-image" id="problemImage"></div>
                        <div class="problem-text" id="problemText">ë¬¸ì œ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
                        <div class="options" id="optionsContainer"></div>
                        <div class="buttons">
                            <button class="btn btn-secondary" id="hintBtn">ğŸ’¡ íŒíŠ¸</button>
                            <button class="btn btn-primary" id="checkBtn" disabled>ì •ë‹µ í™•ì¸</button>
                            <button class="btn btn-primary" id="nextBtn" style="display: none;">ë‹¤ìŒ ë¬¸ì œ</button>
                        </div>
                        <div class="feedback" id="feedback">
                            <div id="feedbackText"></div>
                            <div class="explanation" id="explanation"></div>
                        </div>
                    `;
                    
                    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¬ì—°ê²°
                    const hintBtn = document.getElementById('hintBtn');
                    const checkBtn = document.getElementById('checkBtn');
                    const nextBtn = document.getElementById('nextBtn');
                    
                    if (hintBtn) hintBtn.addEventListener('click', showHint);
                    if (checkBtn) checkBtn.addEventListener('click', checkAnswer);
                    if (nextBtn) nextBtn.addEventListener('click', nextProblem);
                    
                    showProblem();
                }
            }
        });
    </script>
</body>
</html>
