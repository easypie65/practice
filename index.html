<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ï§ë3 ÏÇºÍ∞ÅÎπÑ Ï¥ùÎ≥µÏäµ - ÎßûÏ∂§Ìòï Î¨∏Ï†úÏùÄÌñâ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .progress-section {
            padding: 20px 30px;
            background: #f8f9ff;
            border-bottom: 1px solid #e0e6ff;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e6ff;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            text-align: center;
        }

        .stat {
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-width: 120px;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .main-content {
            display: flex;
            min-height: 600px;
        }

        .sidebar {
            width: 300px;
            background: #f8f9ff;
            padding: 30px;
            border-right: 1px solid #e0e6ff;
        }

        .topic-list {
            list-style: none;
        }

        .topic-item {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .topic-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .topic-item.active {
            border-color: #4facfe;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .topic-item.completed::after {
            content: '‚úì';
            position: absolute;
            right: 15px;
            top: 15px;
            color: #4caf50;
            font-weight: bold;
            font-size: 1.2em;
        }

        .content-area {
            flex: 1;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .problem-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            max-width: 600px;
            width: 100%;
            margin-bottom: 30px;
            display: none;
        }

        .problem-card.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .problem-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .problem-image {
            text-align: center;
            margin: 20px 0;
        }

        .problem-text {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 25px;
            color: #555;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #e0e6ff;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1em;
        }

        .option:hover {
            border-color: #4facfe;
            background: #f8f9ff;
        }

        .option.selected {
            border-color: #4facfe;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .option.correct {
            border-color: #4caf50;
            background: #e8f5e8;
            color: #2e7d32;
        }

        .option.wrong {
            border-color: #f44336;
            background: #ffebee;
            color: #c62828;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-secondary {
            background: #f0f2f5;
            color: #666;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            display: none;
        }

        .feedback.correct {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            color: #2e7d32;
        }

        .feedback.wrong {
            background: #ffebee;
            border: 2px solid #f44336;
            color: #c62828;
        }

        .explanation {
            margin-top: 15px;
            font-size: 1em;
            line-height: 1.5;
        }

        .reference-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .reference-title {
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
        }

        .formulas {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
        }

        .formula {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .welcome-screen {
            text-align: center;
        }

        .welcome-title {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 20px;
        }

        .welcome-text {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .start-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(79, 172, 254, 0.4);
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî∫ ÏÇºÍ∞ÅÎπÑ ÎßàÏä§ÌÑ∞</h1>
            <p>Ï§ëÌïôÍµê 3ÌïôÎÖÑ ÏÇºÍ∞ÅÎπÑ Ï¥ù Î≥µÏäµ - ÎßûÏ∂§Ìòï Î¨∏Ï†úÏùÄÌñâ</p>
        </div>

        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-number" id="totalSolved">0</div>
                    <div>Ìï¥Í≤∞Ìïú Î¨∏Ï†ú</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="correctRate">0%</div>
                    <div>Ï†ïÎãµÎ•†</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="currentStreak">0</div>
                    <div>Ïó∞ÏÜç Ï†ïÎãµ</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <div class="reference-card">
                    <div class="reference-title">üìê ÏÇºÍ∞ÅÎπÑ Í≥µÏãù</div>
                    <div class="formulas">
                        <div class="formula">sin Œ∏ = ÎåÄÎ≥Ä/ÎπóÎ≥Ä</div>
                        <div class="formula">cos Œ∏ = Ïù∏Î≥Ä/ÎπóÎ≥Ä</div>
                        <div class="formula">tan Œ∏ = ÎåÄÎ≥Ä/Ïù∏Î≥Ä</div>
                    </div>
                </div>

                <!-- ÏßÑÌñâÏÉÅÌô© Í¥ÄÎ¶¨ Î≤ÑÌäº -->
                <div style="background: #f8f9ff; padding: 15px; border-radius: 15px; margin-bottom: 20px; text-align: center;">
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 10px;">ÏßÑÌñâÏÉÅÌô© Í¥ÄÎ¶¨</div>
                    <button class="btn btn-secondary" onclick="resetProgress()" style="padding: 8px 16px; font-size: 0.9em;">Ï≤òÏùåÎ∂ÄÌÑ∞ Îã§Ïãú ÏãúÏûë</button>
                </div>
                
                <ul class="topic-list">
                    <li class="topic-item" data-topic="basic">
                        <strong>Í∏∞Î≥∏ Í∞úÎÖê</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">ÏÇºÍ∞ÅÎπÑÏùò Ï†ïÏùòÏôÄ Í∏∞Î≥∏ Í∞úÎÖê</div>
                    </li>
                    <li class="topic-item" data-topic="calculation">
                        <strong>ÏÇºÍ∞ÅÎπÑ Í≥ÑÏÇ∞</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">Ï£ºÏñ¥ÏßÑ Ï°∞Í±¥ÏúºÎ°ú ÏÇºÍ∞ÅÎπÑ Íµ¨ÌïòÍ∏∞</div>
                    </li>
                    <li class="topic-item" data-topic="special">
                        <strong>ÌäπÏàòÍ∞Å</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">30¬∞, 45¬∞, 60¬∞ ÏÇºÍ∞ÅÎπÑ</div>
                    </li>
                    <li class="topic-item" data-topic="application">
                        <strong>ÌôúÏö© Î¨∏Ï†ú</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">Ïã§ÏÉùÌôú Î¨∏Ï†ú Ìï¥Í≤∞ÌïòÍ∏∞</div>
                    </li>
                    <li class="topic-item" data-topic="mixed">
                        <strong>Ï¢ÖÌï© Î¨∏Ï†ú</strong>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">Î™®Îì† ÎÇ¥Ïö©ÏùÑ Ï¢ÖÌï©Ìïú Î¨∏Ï†ú</div>
                    </li>
                </ul>
            </div>

            <div class="content-area">
                <div id="welcomeScreen" class="welcome-screen">
                    <h2 class="welcome-title">ÏÇºÍ∞ÅÎπÑ Ï¥ùÎ≥µÏäµÏùÑ ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî! üöÄ</h2>
                    <p class="welcome-text">
                        ÏôºÏ™ΩÏóêÏÑú ÌïôÏäµÌïòÍ≥† Ïã∂ÏùÄ Ï£ºÏ†úÎ•º ÏÑ†ÌÉùÌïòÎ©¥<br>
                        ÎßûÏ∂§Ìòï Î¨∏Ï†úÎì§Ïù¥ Ï∞®Î°ÄÎåÄÎ°ú ÎÇòÌÉÄÎÇ©ÎãàÎã§.<br>
                        Í∞Å Î¨∏Ï†úÎßàÎã§ ÏûêÏÑ∏Ìïú Ìï¥ÏÑ§Í≥º Ìï®Íªò Ïã§Î†•ÏùÑ ÌÇ§ÏõåÎ≥¥ÏÑ∏Ïöî!
                    </p>
                    <button class="start-btn" data-topic="basic">Í∏∞Î≥∏ Í∞úÎÖêÎ∂ÄÌÑ∞ ÏãúÏûëÌïòÍ∏∞</button>
                </div>

                <div id="problemCard" class="problem-card">
                    <h3 class="problem-title" id="problemTitle">Î¨∏Ï†ú</h3>
                    <div class="problem-image" id="problemImage"></div>
                    <div class="problem-text" id="problemText">Î¨∏Ï†ú ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</div>
                    <div class="options" id="optionsContainer"></div>
                    <div class="buttons">
                        <button class="btn btn-secondary" id="hintBtn">üí° ÌûåÌä∏</button>
                        <button class="btn btn-primary" id="checkBtn" disabled>Ï†ïÎãµ ÌôïÏù∏</button>
                        <button class="btn btn-primary" id="nextBtn" style="display: none;">Îã§Ïùå Î¨∏Ï†ú</button>
                    </div>
                    <div class="feedback" id="feedback">
                        <div id="feedbackText"></div>
                        <div class="explanation" id="explanation"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let currentTopic = '';
        let currentProblemIndex = 0;
        let selectedAnswer = null;
        let stats = {
            totalSolved: 0,
            correctAnswers: 0,
            currentStreak: 0
        };

        // Î¨∏Ï†ú Î≥ÄÌòï Ìï®ÏàòÎì§
        function getRandomNumbers() {
            const sets = [
                {hypotenuse: "10", opposite: "6", adjacent: "8"},
                {hypotenuse: "13", opposite: "5", adjacent: "12"},
                {hypotenuse: "15", opposite: "9", adjacent: "12"},
                {hypotenuse: "17", opposite: "8", adjacent: "15"},
                {hypotenuse: "25", opposite: "15", adjacent: "20"},
                {hypotenuse: "26", opposite: "10", adjacent: "24"}
            ];
            return sets[Math.floor(Math.random() * sets.length)];
        }

        function getRandomFraction() {
            const fractions = [
                {sin: "3/5", cos: "4/5", h: "5", o: "3", a: "4"},
                {sin: "5/13", cos: "12/13", h: "13", o: "5", a: "12"},
                {sin: "8/17", cos: "15/17", h: "17", o: "8", a: "15"},
                {sin: "7/25", cos: "24/25", h: "25", o: "7", a: "24"},
                {sin: "9/15", cos: "12/15", h: "15", o: "9", a: "12"}
            ];
            return fractions[Math.floor(Math.random() * fractions.length)];
        }

        function getRandomBuilding() {
            const buildings = [
                {height: "20", distance: "50", answer: "2/5"},
                {height: "15", distance: "36", answer: "5/12"},
                {height: "24", distance: "32", answer: "3/4"},
                {height: "18", distance: "24", answer: "3/4"},
                {height: "30", distance: "40", answer: "3/4"}
            ];
            return buildings[Math.floor(Math.random() * buildings.length)];
        }

        // Ï∫°Ï≤ò Î∞è ÏóÖÎ°úÎìú Ìï®Ïàò
        function captureAndUpload() {
            // ÌôîÎ©¥ Ï∫°Ï≤ò (html2canvas ÎùºÏù¥Î∏åÎü¨Î¶¨ ÌïÑÏöî)
            if (typeof html2canvas !== 'undefined') {
                html2canvas(document.body).then(canvas => {
                    // Ï∫îÎ≤ÑÏä§Î•º Ïù¥ÎØ∏ÏßÄÎ°ú Î≥ÄÌôò
                    const imageData = canvas.toDataURL('image/png');
                    
                    // Îã§Ïö¥Î°úÎìú ÎßÅÌÅ¨ ÏÉùÏÑ±
                    const link = document.createElement('a');
                    link.download = `ÏÇºÍ∞ÅÎπÑÎßàÏä§ÌÑ∞_100%Îã¨ÏÑ±_${new Date().toLocaleDateString()}.png`;
                    link.href = imageData;
                    link.click();
                    
                    // ÏóÖÎ°úÎìú ÏïàÎÇ¥
                    showUploadGuide();
                });
            } else {
                // html2canvasÍ∞Ä ÏóÜÏúºÎ©¥ Ïä§ÌÅ¨Î¶∞ÏÉ∑ ÏïàÎÇ¥
                showScreenshotGuide();
            }
        }

        function showUploadGuide() {
            const uploadModal = document.createElement('div');
            uploadModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            uploadModal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 20px; max-width: 500px; text-align: center;">
                    <h2 style="color: #27ae60; margin-bottom: 20px;">üéâ 100% Îã¨ÏÑ± Ï∂ïÌïòÌï©ÎãàÎã§!</h2>
                    <p style="margin-bottom: 20px; line-height: 1.6;">
                        ÌôîÎ©¥Ïù¥ Ï∫°Ï≤òÎêòÏñ¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!<br>
                        <strong>3ÌïôÎÖÑ 6Î∞ò</strong> ÌïôÏÉùÎì§ÏùÄ ÏïÑÎûò ÎßÅÌÅ¨ÏóêÏÑú Ïù∏Ï¶ùÏÉ∑ÏùÑ Ïò¨Î†§Ï£ºÏÑ∏Ïöî!
                    </p>
                    <div style="background: #f8f9ff; padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <strong>ÏóÖÎ°úÎìú ÎßÅÌÅ¨:</strong><br>
                        <a href="https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638" 
                           target="_blank" 
                           style="color: #4facfe; word-break: break-all;">
                            https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638
                        </a>
                    </div>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="window.open('https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638', '_blank')" 
                                style="background: #27ae60; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: bold;">
                            ÏóÖÎ°úÎìúÌïòÎü¨ Í∞ÄÍ∏∞
                        </button>
                        <button onclick="this.closest('div').parentElement.remove()" 
                                style="background: #95a5a6; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer;">
                            Îã´Í∏∞
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(uploadModal);
        }

        function showScreenshotGuide() {
            const screenshotModal = document.createElement('div');
            screenshotModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            screenshotModal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 20px; max-width: 500px; text-align: center;">
                    <h2 style="color: #27ae60; margin-bottom: 20px;">üéâ 100% Îã¨ÏÑ± Ï∂ïÌïòÌï©ÎãàÎã§!</h2>
                    <p style="margin-bottom: 20px; line-height: 1.6;">
                        Ïù¥ ÌôîÎ©¥ÏùÑ Ïä§ÌÅ¨Î¶∞ÏÉ∑ÏúºÎ°ú Ï∫°Ï≤òÌï¥Ï£ºÏÑ∏Ïöî!<br>
                        <small style="color: #666;">(Windows: Win+Shift+S, Mac: Cmd+Shift+4)</small>
                    </p>
                    <p style="margin-bottom: 20px;">
                        <strong>3ÌïôÎÖÑ 6Î∞ò</strong> ÌïôÏÉùÎì§ÏùÄ ÏïÑÎûò ÎßÅÌÅ¨ÏóêÏÑú Ïù∏Ï¶ùÏÉ∑ÏùÑ Ïò¨Î†§Ï£ºÏÑ∏Ïöî!
                    </p>
                    <div style="background: #f8f9ff; padding: 15px; border-radius: 10px; margin: 20px 0;">
                        <strong>ÏóÖÎ°úÎìú ÎßÅÌÅ¨:</strong><br>
                        <a href="https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638" 
                           target="_blank" 
                           style="color: #4facfe; word-break: break-all;">
                            https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638
                        </a>
                    </div>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="window.open('https://b.tkbell.co.kr/tkboard/woi/1243615/6meBlp16an.do?pageSeq=1909638', '_blank')" 
                                style="background: #27ae60; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: bold;">
                            ÏóÖÎ°úÎìúÌïòÎü¨ Í∞ÄÍ∏∞
                        </button>
                        <button onclick="this.closest('div').parentElement.remove()" 
                                style="background: #95a5a6; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer;">
                            Îã´Í∏∞
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(screenshotModal);
        }
        function saveProgress() {
            const progressData = {
                stats: stats,
                currentTopic: currentTopic,
                currentProblemIndex: currentProblemIndex,
                completedTopics: []
            };
            
            // ÏôÑÎ£åÎêú Ï£ºÏ†úÎì§ Ï†ÄÏû•
            document.querySelectorAll('.topic-item.completed').forEach(item => {
                progressData.completedTopics.push(item.getAttribute('data-topic'));
            });
            
            localStorage.setItem('trigonometry_progress', JSON.stringify(progressData));
        }

        function loadProgress() {
            const saved = localStorage.getItem('trigonometry_progress');
            if (saved) {
                const progressData = JSON.parse(saved);
                
                // ÌÜµÍ≥Ñ Î≥µÏõê
                stats = progressData.stats || {
                    totalSolved: 0,
                    correctAnswers: 0,
                    currentStreak: 0
                };
                
                // ÌòÑÏû¨ ÏßÑÌñâ ÏÉÅÌô© Î≥µÏõê
                currentTopic = progressData.currentTopic || '';
                currentProblemIndex = progressData.currentProblemIndex || 0;
                
                // ÏôÑÎ£åÎêú Ï£ºÏ†úÎì§ ÌëúÏãú Î≥µÏõê
                if (progressData.completedTopics) {
                    progressData.completedTopics.forEach(topic => {
                        const topicItem = document.querySelector(`[data-topic="${topic}"]`);
                        if (topicItem) {
                            topicItem.classList.add('completed');
                        }
                    });
                }
                
                return true;
            }
            return false;
        }

        function resetProgress() {
            localStorage.removeItem('trigonometry_progress');
            
            // ÌÜµÍ≥Ñ Ï¥àÍ∏∞Ìôî
            stats = {
                totalSolved: 0,
                correctAnswers: 0,
                currentStreak: 0
            };
            
            // ÌòÑÏû¨ ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
            currentTopic = '';
            currentProblemIndex = 0;
            
            // ÏôÑÎ£å ÌëúÏãú Ï†úÍ±∞
            document.querySelectorAll('.topic-item').forEach(item => {
                item.classList.remove('completed');
                item.classList.remove('active');
            });
            
            // ÌôòÏòÅ ÌôîÎ©¥ÏúºÎ°ú Î≥µÍ∑Ä
            const welcomeScreen = document.getElementById('welcomeScreen');
            const problemCard = document.getElementById('problemCard');
            
            if (welcomeScreen) welcomeScreen.style.display = 'block';
            if (problemCard) problemCard.style.display = 'none';
            
            updateStats();
        }
        function generateProblem(baseProblem, variation = 0) {
            const newProblem = JSON.parse(JSON.stringify(baseProblem)); // ÍπäÏùÄ Î≥µÏÇ¨
            
            if (baseProblem.title.includes("Í∏∞Î≥∏ Í∞úÎÖê")) {
                const numbers = getRandomNumbers();
                newProblem.image = createTriangleImage(numbers.hypotenuse, numbers.opposite, numbers.adjacent, "Œ∏");
                
                if (baseProblem.title.includes("1")) { // sin Î¨∏Ï†ú
                    const sinValue = (parseFloat(numbers.opposite) / parseFloat(numbers.hypotenuse)).toFixed(2);
                    newProblem.text = `ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†A = Œ∏Ïùº Îïå, sin Œ∏Ïùò Í∞íÏùÄ?`;
                    newProblem.options = [sinValue, "0.8", "0.75", "1.2"];
                    newProblem.correct = 0;
                    newProblem.explanation = `Í∞Å AÏóêÏÑú Î≥¥Î©¥ ÎåÄÎ≥ÄÏùÄ BC = ${numbers.opposite}, ÎπóÎ≥ÄÏùÄ AC = ${numbers.hypotenuse}Ïù¥ÎØÄÎ°ú\nsin Œ∏ = sin A = ÎåÄÎ≥Ä/ÎπóÎ≥Ä = ${numbers.opposite}/${numbers.hypotenuse} = ${sinValue}ÏûÖÎãàÎã§.`;
                } else if (baseProblem.title.includes("2")) { // cos Î¨∏Ï†ú
                    const cosValue = (parseFloat(numbers.adjacent) / parseFloat(numbers.hypotenuse)).toFixed(2);
                    newProblem.text = `ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†A = Œ∏Ïùº Îïå, cos Œ∏Ïùò Í∞íÏùÄ?`;
                    newProblem.options = ["0.6", cosValue, "1.25", "0.75"];
                    newProblem.correct = 1;
                    newProblem.explanation = `Í∞Å AÏóêÏÑú Î≥¥Î©¥ Ïù∏Î≥ÄÏùÄ AB = ${numbers.adjacent}, ÎπóÎ≥ÄÏùÄ AC = ${numbers.hypotenuse}Ïù¥ÎØÄÎ°ú\ncos Œ∏ = cos A = Ïù∏Î≥Ä/ÎπóÎ≥Ä = ${numbers.adjacent}/${numbers.hypotenuse} = ${cosValue}ÏûÖÎãàÎã§.`;
                } else if (baseProblem.title.includes("3")) { // tan Î¨∏Ï†ú
                    const tanValue = (parseFloat(numbers.opposite) / parseFloat(numbers.adjacent)).toFixed(2);
                    newProblem.text = `ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†A = Œ∏Ïùº Îïå, tan Œ∏Ïùò Í∞íÏùÄ?`;
                    newProblem.options = [tanValue, "1.33", "0.6", "0.8"];
                    newProblem.correct = 0;
                    newProblem.explanation = `Í∞Å AÏóêÏÑú Î≥¥Î©¥ ÎåÄÎ≥ÄÏùÄ BC = ${numbers.opposite}, Ïù∏Î≥ÄÏùÄ AB = ${numbers.adjacent}Ïù¥ÎØÄÎ°ú\ntan Œ∏ = tan A = ÎåÄÎ≥Ä/Ïù∏Î≥Ä = ${numbers.opposite}/${numbers.adjacent} = ${tanValue}ÏûÖÎãàÎã§.`;
                }
            } else if (baseProblem.title.includes("Í≥ÑÏÇ∞ Î¨∏Ï†ú 1")) {
                const frac = getRandomFraction();
                newProblem.text = `ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†B = 90¬∞Ïù¥Í≥†, ‚à†A = Œ∏, sin Œ∏ = ${frac.sin}Ïùº Îïå, cos Œ∏Ïùò Í∞íÏùÄ?`;
                newProblem.options = [frac.cos, "3/4", "5/4", "5/3"];
                newProblem.correct = 0;
                newProblem.explanation = `sin Œ∏ = ${frac.sin}Ïù¥ÎØÄÎ°ú ÎåÄÎ≥Ä:ÎπóÎ≥Ä = ${frac.o}:${frac.h}ÏûÖÎãàÎã§.\nÌîºÌÉÄÍ≥†ÎùºÏä§ Ï†ïÎ¶¨Î°ú Ïù∏Î≥ÄÏùÑ Íµ¨ÌïòÎ©¥: Ïù∏Î≥Ä = ‚àö(${frac.h}¬≤ - ${frac.o}¬≤) = ${frac.a}\nÎî∞ÎùºÏÑú cos Œ∏ = Ïù∏Î≥Ä/ÎπóÎ≥Ä = ${frac.a}/${frac.h} = ${frac.cos}ÏûÖÎãàÎã§.`;
            } else if (baseProblem.title.includes("ÌôúÏö© Î¨∏Ï†ú 1")) {
                const building = getRandomBuilding();
                newProblem.text = `ÎÜíÏù¥ ${building.height}mÏù∏ Í±¥Î¨ºÏùÑ ${building.distance}m Í±∞Î¶¨ÏóêÏÑú Ïò¨Î†§Îã§Î≥∏ Í∞ÅÏùÑ Œ∏Îùº Ìï† Îïå, tan Œ∏Îäî?`;
                newProblem.options = [building.answer, "5/2", "3/4", "4/3"];
                newProblem.correct = 0;
                newProblem.explanation = `tan Œ∏ = ÎåÄÎ≥Ä/Ïù∏Î≥Ä = Í±¥Î¨ºÎÜíÏù¥/Í±∞Î¶¨ = ${building.height}/${building.distance} = ${building.answer}ÏûÖÎãàÎã§.`;
                newProblem.image = `<div style="text-align: center;"><svg width="250" height="140" viewBox="0 0 250 140"><rect x="180" y="40" width="15" height="80" fill="#4facfe"/><line x1="20" y1="120" x2="220" y2="120" stroke="#333" stroke-width="2"/><line x1="50" y1="120" x2="185" y2="40" stroke="#e74c3c" stroke-width="2" stroke-dasharray="3,3"/><text x="115" y="135" text-anchor="middle" font-size="12" fill="#333">${building.distance}m</text><text x="205" y="85" font-size="12" fill="#333">${building.height}m</text><text x="60" y="110" font-size="12" fill="#e74c3c" font-weight="bold">Œ∏</text></svg></div>`;
            }
            
            return newProblem;
        }
        function createTriangleImage(hypotenuse, opposite, adjacent, angle) {
            return `
                <svg width="250" height="180" viewBox="0 0 250 180">
                    <polygon points="30,140 170,140 170,50" fill="rgba(79, 172, 254, 0.1)" stroke="#4facfe" stroke-width="3"/>
                    <rect x="162" y="132" width="8" height="8" fill="none" stroke="#666" stroke-width="1"/>
                    <path d="M 40,140 A 10,10 0 0,0 47,133" fill="none" stroke="#e74c3c" stroke-width="2"/>
                    <text x="50" y="132" font-size="16" fill="#e74c3c" font-weight="bold">${angle}</text>
                    <text x="100" y="155" text-anchor="middle" font-size="14" fill="#2c3e50" font-weight="bold">Ïù∏Î≥Ä = ${adjacent}</text>
                    <text x="185" y="95" text-anchor="middle" font-size="14" fill="#2c3e50" font-weight="bold">ÎåÄÎ≥Ä = ${opposite}</text>
                    <text x="95" y="90" text-anchor="middle" font-size="14" fill="#2c3e50" font-weight="bold">ÎπóÎ≥Ä = ${hypotenuse}</text>
                    <circle cx="30" cy="140" r="3" fill="#e74c3c"/>
                    <circle cx="170" cy="140" r="3" fill="#2c3e50"/>
                    <circle cx="170" cy="50" r="3" fill="#2c3e50"/>
                    <text x="25" y="155" font-size="16" fill="#e74c3c" font-weight="bold">A</text>
                    <text x="175" y="155" font-size="16" fill="#2c3e50" font-weight="bold">B</text>
                    <text x="175" y="45" font-size="16" fill="#2c3e50" font-weight="bold">C</text>
                    <text x="150" y="155" font-size="12" fill="#666">90¬∞</text>
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c"/>
                        </marker>
                    </defs>
                    <path d="M 45,125 Q 55,120 45,115" fill="none" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrowhead)"/>
                </svg>
            `;
        }

        // Î¨∏Ï†ú Îç∞Ïù¥ÌÑ∞
        const problemSets = {
            basic: [
                {
                    title: "Í∏∞Î≥∏ Í∞úÎÖê 1",
                    text: "ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†A = Œ∏Ïùº Îïå, sin Œ∏Ïùò Í∞íÏùÄ?",
                    image: createTriangleImage("10", "6", "8", "Œ∏"),
                    options: ["0.6", "0.8", "0.75", "1.2"],
                    correct: 0,
                    explanation: "Í∞Å AÏóêÏÑú Î≥¥Î©¥ ÎåÄÎ≥ÄÏùÄ BC = 6, ÎπóÎ≥ÄÏùÄ AC = 10Ïù¥ÎØÄÎ°ú\nsin Œ∏ = sin A = ÎåÄÎ≥Ä/ÎπóÎ≥Ä = 6/10 = 0.6ÏûÖÎãàÎã§.",
                    hint: "Í∞Å A(Œ∏)ÏóêÏÑú ÎåÄÎ≥ÄÏùÄ ÎßûÏùÄÌé∏ Î≥Ä BCÏù¥Í≥†, ÎπóÎ≥ÄÏùÄ ACÏûÖÎãàÎã§. sin Œ∏ = ÎåÄÎ≥Ä/ÎπóÎ≥ÄÏù¥ÏóêÏöî."
                },
                {
                    title: "Í∏∞Î≥∏ Í∞úÎÖê 2",
                    text: "ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†A = Œ∏Ïùº Îïå, cos Œ∏Ïùò Í∞íÏùÄ?",
                    image: createTriangleImage("10", "6", "8", "Œ∏"),
                    options: ["0.6", "0.8", "1.25", "0.75"],
                    correct: 1,
                    explanation: "Í∞Å AÏóêÏÑú Î≥¥Î©¥ Ïù∏Î≥ÄÏùÄ AB = 8, ÎπóÎ≥ÄÏùÄ AC = 10Ïù¥ÎØÄÎ°ú\ncos Œ∏ = cos A = Ïù∏Î≥Ä/ÎπóÎ≥Ä = 8/10 = 0.8ÏûÖÎãàÎã§.",
                    hint: "Í∞Å A(Œ∏)ÏóêÏÑú Ïù∏Î≥ÄÏùÄ Ïù∏Ï†ëÌïú Î≥Ä ABÏù¥Í≥†, ÎπóÎ≥ÄÏùÄ ACÏûÖÎãàÎã§. cos Œ∏ = Ïù∏Î≥Ä/ÎπóÎ≥ÄÏù¥ÏóêÏöî."
                },
                {
                    title: "Í∏∞Î≥∏ Í∞úÎÖê 3",
                    text: "ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†A = Œ∏Ïùº Îïå, tan Œ∏Ïùò Í∞íÏùÄ?",
                    image: createTriangleImage("10", "6", "8", "Œ∏"),
                    options: ["0.75", "1.33", "0.6", "0.8"],
                    correct: 0,
                    explanation: "Í∞Å AÏóêÏÑú Î≥¥Î©¥ ÎåÄÎ≥ÄÏùÄ BC = 6, Ïù∏Î≥ÄÏùÄ AB = 8Ïù¥ÎØÄÎ°ú\ntan Œ∏ = tan A = ÎåÄÎ≥Ä/Ïù∏Î≥Ä = 6/8 = 0.75ÏûÖÎãàÎã§.",
                    hint: "Í∞Å A(Œ∏)ÏóêÏÑú ÎåÄÎ≥ÄÏùÄ BC, Ïù∏Î≥ÄÏùÄ ABÏûÖÎãàÎã§. tan Œ∏ = ÎåÄÎ≥Ä/Ïù∏Î≥ÄÏù¥ÏóêÏöî."
                }
            ],
            calculation: [
                {
                    title: "Í≥ÑÏÇ∞ Î¨∏Ï†ú 1",
                    text: "ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†B = 90¬∞Ïù¥Í≥†, ‚à†A = Œ∏, sin Œ∏ = 3/5Ïùº Îïå, cos Œ∏Ïùò Í∞íÏùÄ?",
                    image: "",
                    options: ["4/5", "3/4", "5/4", "5/3"],
                    correct: 0,
                    explanation: "sin Œ∏ = 3/5Ïù¥ÎØÄÎ°ú ÎåÄÎ≥Ä:ÎπóÎ≥Ä = 3:5ÏûÖÎãàÎã§.\nÌîºÌÉÄÍ≥†ÎùºÏä§ Ï†ïÎ¶¨Î°ú Ïù∏Î≥ÄÏùÑ Íµ¨ÌïòÎ©¥: Ïù∏Î≥Ä = ‚àö(5¬≤ - 3¬≤) = ‚àö(25 - 9) = ‚àö16 = 4\nÎî∞ÎùºÏÑú cos Œ∏ = Ïù∏Î≥Ä/ÎπóÎ≥Ä = 4/5ÏûÖÎãàÎã§.",
                    hint: "sin¬≤Œ∏ + cos¬≤Œ∏ = 1 ÎòêÎäî ÌîºÌÉÄÍ≥†ÎùºÏä§ Ï†ïÎ¶¨Î•º Ïù¥Ïö©Ìï¥Î≥¥ÏÑ∏Ïöî."
                },
                {
                    title: "Í≥ÑÏÇ∞ Î¨∏Ï†ú 2",
                    text: "ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†C = 90¬∞Ïù¥Í≥†, ‚à†A = Œ≤, AB = 13, BC = 5Ïùº Îïå, tan Œ≤Îäî?",
                    image: "",
                    options: ["5/12", "12/5", "5/13", "12/13"],
                    correct: 0,
                    explanation: "‚à†C = 90¬∞Ïù¥ÎØÄÎ°ú ABÍ∞Ä ÎπóÎ≥ÄÏûÖÎãàÎã§.\nÌîºÌÉÄÍ≥†ÎùºÏä§ Ï†ïÎ¶¨Î°ú ACÎ•º Íµ¨ÌïòÎ©¥: AC = ‚àö(AB¬≤ - BC¬≤) = ‚àö(13¬≤ - 5¬≤) = ‚àö(169 - 25) = 12\nÍ∞Å A(Œ≤)ÏóêÏÑú Î≥¥Î©¥ ÎåÄÎ≥ÄÏùÄ BC = 5, Ïù∏Î≥ÄÏùÄ AC = 12Ïù¥ÎØÄÎ°ú\ntan Œ≤ = ÎåÄÎ≥Ä/Ïù∏Î≥Ä = 5/12ÏûÖÎãàÎã§.",
                    hint: "‚à†C = 90¬∞Ïù¥ÎØÄÎ°ú ABÍ∞Ä ÎπóÎ≥ÄÏù¥ÏóêÏöî. Í∞Å Œ≤ÏóêÏÑú ÎåÄÎ≥ÄÍ≥º Ïù∏Î≥ÄÏùÑ Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî."
                }
            ],
            special: [
                {
                    title: "ÌäπÏàòÍ∞Å 1",
                    text: "sin 30¬∞Ïùò Í∞íÏùÄ?",
                    image: "",
                    options: ["1/2", "‚àö2/2", "‚àö3/2", "1"],
                    correct: 0,
                    explanation: "30-60-90 ÏÇºÍ∞ÅÌòïÏóêÏÑú Î≥ÄÏùò ÎπÑÎäî 1:‚àö3:2ÏûÖÎãàÎã§.\n30¬∞ Í∞ÅÏóêÏÑú ÎåÄÎ≥Ä:ÎπóÎ≥Ä = 1:2Ïù¥ÎØÄÎ°ú sin 30¬∞ = 1/2ÏûÖÎãàÎã§.",
                    hint: "30-60-90 ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòïÏùÑ Í∑∏Î†§Î≥¥ÏÑ∏Ïöî. Î≥ÄÏùò ÎπÑÎäî 1:‚àö3:2ÏûÖÎãàÎã§."
                },
                {
                    title: "ÌäπÏàòÍ∞Å 2",
                    text: "cos 45¬∞Ïùò Í∞íÏùÄ?",
                    image: "",
                    options: ["1/2", "‚àö2/2", "‚àö3/2", "1"],
                    correct: 1,
                    explanation: "45-45-90 ÏÇºÍ∞ÅÌòïÏóêÏÑú Î≥ÄÏùò ÎπÑÎäî 1:1:‚àö2ÏûÖÎãàÎã§.\n45¬∞ Í∞ÅÏóêÏÑú Ïù∏Î≥Ä:ÎπóÎ≥Ä = 1:‚àö2Ïù¥ÎØÄÎ°ú cos 45¬∞ = 1/‚àö2 = ‚àö2/2ÏûÖÎãàÎã§.",
                    hint: "45-45-90 ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòïÏùÄ Ïù¥Îì±Î≥ÄÏßÅÍ∞ÅÏÇºÍ∞ÅÌòïÏù¥ÏóêÏöî. Î≥ÄÏùò ÎπÑÎäî 1:1:‚àö2ÏûÖÎãàÎã§."
                },
                {
                    title: "ÌäπÏàòÍ∞Å 3",
                    text: "tan 60¬∞Ïùò Í∞íÏùÄ?",
                    image: "",
                    options: ["1/2", "‚àö2", "‚àö3", "1/‚àö3"],
                    correct: 2,
                    explanation: "30-60-90 ÏÇºÍ∞ÅÌòïÏóêÏÑú Î≥ÄÏùò ÎπÑÎäî 1:‚àö3:2ÏûÖÎãàÎã§.\n60¬∞ Í∞ÅÏóêÏÑú ÎåÄÎ≥Ä:Ïù∏Î≥Ä = ‚àö3:1Ïù¥ÎØÄÎ°ú tan 60¬∞ = ‚àö3ÏûÖÎãàÎã§.",
                    hint: "60¬∞ Í∞ÅÏóêÏÑú ÎåÄÎ≥ÄÍ≥º Ïù∏Î≥ÄÏùò ÎπÑÎ•º ÏÉùÍ∞ÅÌï¥Î≥¥ÏÑ∏Ïöî."
                }
            ],
            application: [
                {
                    title: "ÌôúÏö© Î¨∏Ï†ú 1",
                    text: "ÎÜíÏù¥ 20mÏù∏ Í±¥Î¨ºÏùÑ 50m Í±∞Î¶¨ÏóêÏÑú Ïò¨Î†§Îã§Î≥∏ Í∞ÅÏùÑ Œ∏Îùº Ìï† Îïå, tan Œ∏Îäî?",
                    image: '<div style="text-align: center;"><svg width="250" height="140" viewBox="0 0 250 140"><rect x="180" y="40" width="15" height="80" fill="#4facfe"/><line x1="20" y1="120" x2="220" y2="120" stroke="#333" stroke-width="2"/><line x1="50" y1="120" x2="185" y2="40" stroke="#e74c3c" stroke-width="2" stroke-dasharray="3,3"/><text x="115" y="135" text-anchor="middle" font-size="12" fill="#333">50m</text><text x="205" y="85" font-size="12" fill="#333">20m</text><text x="60" y="110" font-size="12" fill="#e74c3c" font-weight="bold">Œ∏</text></svg></div>',
                    options: ["2/5", "5/2", "3/4", "4/3"],
                    correct: 0,
                    explanation: "tan Œ∏ = ÎåÄÎ≥Ä/Ïù∏Î≥Ä = Í±¥Î¨ºÎÜíÏù¥/Í±∞Î¶¨ = 20/50 = 2/5ÏûÖÎãàÎã§.",
                    hint: "Í±¥Î¨ºÏùò ÎÜíÏù¥Í∞Ä ÎåÄÎ≥Ä, Í±¥Î¨ºÎ°úÎ∂ÄÌÑ∞Ïùò Í±∞Î¶¨Í∞Ä Ïù∏Î≥ÄÏù¥ÏóêÏöî."
                }
            ],
            mixed: [
                {
                    title: "Ï¢ÖÌï© Î¨∏Ï†ú 1",
                    text: "ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†B = 90¬∞Ïù¥Í≥†, ACÍ∞Ä ÎπóÎ≥ÄÏù¥Î©∞ AC = 13, AB = 5Ïùº Îïå, sin AÏùò Í∞íÏùÄ?",
                    image: "",
                    options: ["5/13", "12/13", "5/12", "12/5"],
                    correct: 1,
                    explanation: "‚à†B = 90¬∞Ïù¥ÎØÄÎ°ú ACÍ∞Ä ÎπóÎ≥ÄÏûÖÎãàÎã§.\nÌîºÌÉÄÍ≥†ÎùºÏä§ Ï†ïÎ¶¨Î°ú BCÎ•º Íµ¨ÌïòÎ©¥: BC = ‚àö(AC¬≤ - AB¬≤) = ‚àö(13¬≤ - 5¬≤) = ‚àö(169 - 25) = ‚àö144 = 12\nÍ∞Å AÏóêÏÑú Î≥¥Î©¥ ÎåÄÎ≥ÄÏùÄ BC = 12, ÎπóÎ≥ÄÏùÄ AC = 13Ïù¥ÎØÄÎ°ú\nsin A = ÎåÄÎ≥Ä/ÎπóÎ≥Ä = 12/13ÏûÖÎãàÎã§.",
                    hint: "‚à†B = 90¬∞Ïù¥ÎØÄÎ°ú ACÍ∞Ä ÎπóÎ≥ÄÏù¥ÏóêÏöî. ÌîºÌÉÄÍ≥†ÎùºÏä§ Ï†ïÎ¶¨Î°ú Î®ºÏ†Ä ÎÇòÎ®∏ÏßÄ Ìïú Î≥ÄÏùÑ Íµ¨Ìï¥Î≥¥ÏÑ∏Ïöî."
                },
                {
                    title: "Ï¢ÖÌï© Î¨∏Ï†ú 2",
                    text: "ÏßÅÍ∞ÅÏÇºÍ∞ÅÌòï ABCÏóêÏÑú ‚à†C = 90¬∞Ïù¥Í≥†, ‚à†A = Œ±, AB = 25, BC = 15Ïùº Îïå, cos Œ± + sin Œ±Ïùò Í∞íÏùÄ?",
                    image: "",
                    options: ["1", "7/5", "4/5", "3/5"],
                    correct: 1,
                    explanation: "‚à†C = 90¬∞Ïù¥ÎØÄÎ°ú ABÍ∞Ä ÎπóÎ≥ÄÏûÖÎãàÎã§.\nÌîºÌÉÄÍ≥†ÎùºÏä§ Ï†ïÎ¶¨Î°ú ACÎ•º Íµ¨ÌïòÎ©¥: AC = ‚àö(AB¬≤ - BC¬≤) = ‚àö(25¬≤ - 15¬≤) = ‚àö(625 - 225) = ‚àö400 = 20\nÍ∞Å A(Œ±)ÏóêÏÑú:\n‚Ä¢ ÎåÄÎ≥Ä = BC = 15, Ïù∏Î≥Ä = AC = 20, ÎπóÎ≥Ä = AB = 25\n‚Ä¢ sin Œ± = 15/25 = 3/5\n‚Ä¢ cos Œ± = 20/25 = 4/5\nÎî∞ÎùºÏÑú cos Œ± + sin Œ± = 4/5 + 3/5 = 7/5ÏûÖÎãàÎã§.",
                    hint: "Í∞ÅÍ∞ÅÏùò ÏÇºÍ∞ÅÎπÑÎ•º Íµ¨Ìïú ÌõÑ ÎçîÌï¥Î≥¥ÏÑ∏Ïöî. ‚à†C = 90¬∞ÏûÑÏùÑ ÏûäÏßÄ ÎßàÏÑ∏Ïöî."
                },
                {
                    title: "Ï¢ÖÌï© Î¨∏Ï†ú 3",
                    text: "ÌäπÏàòÍ∞ÅÏùÑ Ïù¥Ïö©ÌïòÏó¨ sin 30¬∞ + cos 60¬∞Ïùò Í∞íÏùÄ?",
                    image: "",
                    options: ["1", "‚àö3/2", "1/2", "‚àö3"],
                    correct: 0,
                    explanation: "ÌäπÏàòÍ∞ÅÏùò Í∞íÏùÑ Ïù¥Ïö©ÌïòÎ©¥:\nsin 30¬∞ = 1/2Ïù¥Í≥†, cos 60¬∞ = 1/2Ïù¥ÎØÄÎ°ú\nsin 30¬∞ + cos 60¬∞ = 1/2 + 1/2 = 1ÏûÖÎãàÎã§.",
                    hint: "ÌäπÏàòÍ∞ÅÏùò ÏÇºÍ∞ÅÎπÑ Í∞íÏùÑ Í∏∞ÏñµÌï¥Î≥¥ÏÑ∏Ïöî. sin 30¬∞ = cos 60¬∞ = 1/2ÏûÖÎãàÎã§."
                }
            ]
        };

        // Ï£ºÏ†ú ÏÑ†ÌÉù Ìï®Ïàò
        function selectTopic(topic) {
            console.log('selectTopic Ìò∏Ï∂úÎê®:', topic); // ÎîîÎ≤ÑÍ∑∏Ïö©
            
            document.querySelectorAll('.topic-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[data-topic="${topic}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }

            currentTopic = topic;
            currentProblemIndex = 0;
            
            const welcomeScreen = document.getElementById('welcomeScreen');
            const problemCard = document.getElementById('problemCard');
            
            if (welcomeScreen) welcomeScreen.style.display = 'none';
            if (problemCard) {
                problemCard.style.display = 'block';
                
                // Í∏∞Î≥∏ Î¨∏Ï†ú Íµ¨Ï°∞Î°ú Ï¥àÍ∏∞Ìôî
                problemCard.innerHTML = `
                    <h3 class="problem-title" id="problemTitle">Î¨∏Ï†ú</h3>
                    <div class="problem-image" id="problemImage"></div>
                    <div class="problem-text" id="problemText">Î¨∏Ï†ú ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</div>
                    <div class="options" id="optionsContainer"></div>
                    <div class="buttons">
                        <button class="btn btn-secondary" id="hintBtn">üí° ÌûåÌä∏</button>
                        <button class="btn btn-primary" id="checkBtn" disabled>Ï†ïÎãµ ÌôïÏù∏</button>
                        <button class="btn btn-primary" id="nextBtn" style="display: none;">Îã§Ïùå Î¨∏Ï†ú</button>
                    </div>
                    <div class="feedback" id="feedback">
                        <div id="feedbackText"></div>
                        <div class="explanation" id="explanation"></div>
                    </div>
                `;
                
                // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îã§Ïãú Ïó∞Í≤∞
                const hintBtn = document.getElementById('hintBtn');
                const checkBtn = document.getElementById('checkBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                if (hintBtn) hintBtn.addEventListener('click', showHint);
                if (checkBtn) checkBtn.addEventListener('click', checkAnswer);
                if (nextBtn) nextBtn.addEventListener('click', nextProblem);
            }
            
            showProblem();
        }

        // Î¨∏Ï†ú ÌëúÏãú Ìï®Ïàò
        function showProblem() {
            const problems = problemSets[currentTopic];
            if (!problems || currentProblemIndex >= problems.length) {
                showTopicComplete();
                return;
            }

            const problem = problems[currentProblemIndex];
            
            const titleElement = document.getElementById('problemTitle');
            const textElement = document.getElementById('problemText');
            const imageElement = document.getElementById('problemImage');
            const optionsContainer = document.getElementById('optionsContainer');
            const feedbackElement = document.getElementById('feedback');
            
            if (titleElement) titleElement.textContent = problem.title;
            if (textElement) textElement.textContent = problem.text;
            if (imageElement) imageElement.innerHTML = problem.image || '';
            
            if (optionsContainer) {
                optionsContainer.innerHTML = '';
                
                problem.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    optionDiv.textContent = option;
                    optionDiv.onclick = () => selectOption(index);
                    optionsContainer.appendChild(optionDiv);
                });
            }
            
            resetButtons();
            selectedAnswer = null;
            if (feedbackElement) feedbackElement.style.display = 'none';
        }

        // ÏÑ†ÌÉùÏßÄ ÏÑ†ÌÉù
        function selectOption(index) {
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            const options = document.querySelectorAll('.option');
            if (options[index]) {
                options[index].classList.add('selected');
                selectedAnswer = index;
                
                const checkBtn = document.getElementById('checkBtn');
                if (checkBtn) {
                    checkBtn.disabled = false;
                }
            }
        }

        // ÌûåÌä∏ ÌëúÏãú
        function showHint() {
            const problem = problemSets[currentTopic][currentProblemIndex];
            alert('üí° ÌûåÌä∏: ' + problem.hint);
        }

        // Ï†ïÎãµ ÌôïÏù∏
        function checkAnswer() {
            if (selectedAnswer === null) return;
            
            const problem = problemSets[currentTopic][currentProblemIndex];
            const isCorrect = selectedAnswer === problem.correct;
            
            stats.totalSolved++;
            if (isCorrect) {
                stats.correctAnswers++;
                stats.currentStreak++;
            } else {
                stats.currentStreak = 0;
            }
            
            document.querySelectorAll('.option').forEach((opt, index) => {
                if (index === problem.correct) {
                    opt.classList.add('correct');
                } else if (index === selectedAnswer && !isCorrect) {
                    opt.classList.add('wrong');
                }
            });
            
            const feedback = document.getElementById('feedback');
            const feedbackText = document.getElementById('feedbackText');
            const explanation = document.getElementById('explanation');
            const checkBtn = document.getElementById('checkBtn');
            const nextBtn = document.getElementById('nextBtn');
            const hintBtn = document.getElementById('hintBtn');
            
            if (feedback) {
                feedback.className = `feedback ${isCorrect ? 'correct' : 'wrong'}`;
                feedback.style.display = 'block';
            }
            
            if (feedbackText) {
                feedbackText.textContent = isCorrect ? 'üéâ Ï†ïÎãµÏûÖÎãàÎã§!' : '‚ùå ÌãÄÎ†∏ÏäµÎãàÎã§.';
            }
            
            if (explanation) {
                explanation.textContent = problem.explanation;
            }
            
            if (checkBtn) checkBtn.style.display = 'none';
            if (nextBtn) nextBtn.style.display = 'inline-block';
            if (hintBtn) hintBtn.style.display = 'none';
            
            updateStats();
        }

        // Îã§Ïùå Î¨∏Ï†ú
        function nextProblem() {
            currentProblemIndex++;
            showProblem();
        }

        // Î≤ÑÌäº ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
        function resetButtons() {
            const checkBtn = document.getElementById('checkBtn');
            const nextBtn = document.getElementById('nextBtn');
            const hintBtn = document.getElementById('hintBtn');
            
            if (checkBtn) {
                checkBtn.style.display = 'inline-block';
                checkBtn.disabled = true;
            }
            
            if (nextBtn) {
                nextBtn.style.display = 'none';
            }
            
            if (hintBtn) {
                hintBtn.style.display = 'inline-block';
            }
        }

        // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏ (ÏßÑÌñâÏÉÅÌô© Ï†ÄÏû• Ï∂îÍ∞Ä)
        function updateStats() {
            const totalSolvedElement = document.getElementById('totalSolved');
            const correctRateElement = document.getElementById('correctRate');
            const currentStreakElement = document.getElementById('currentStreak');
            const progressFillElement = document.getElementById('progressFill');
            
            if (totalSolvedElement) {
                totalSolvedElement.textContent = stats.totalSolved;
            }
            
            if (correctRateElement) {
                correctRateElement.textContent = 
                    stats.totalSolved > 0 ? Math.round((stats.correctAnswers / stats.totalSolved) * 100) + '%' : '0%';
            }
            
            if (currentStreakElement) {
                currentStreakElement.textContent = stats.currentStreak;
            }
            
            if (progressFillElement) {
                const totalProblems = Object.values(problemSets).reduce((sum, problems) => sum + problems.length, 0);
                const progress = (stats.totalSolved / totalProblems) * 100;
                progressFillElement.style.width = progress + '%';
            }
            
            // ÏßÑÌñâ ÏÉÅÌô© ÏûêÎèô Ï†ÄÏû•
            saveProgress();
        }

        // Ï£ºÏ†ú ÏôÑÎ£å ÌëúÏãú
        function showTopicComplete() {
            const correctRate = stats.totalSolved > 0 ? Math.round((stats.correctAnswers / stats.totalSolved) * 100) : 0;
            
            // Î™®Îì† Ï£ºÏ†úÏóê 66% Í∏∞Ï§Ä Ï†ÅÏö©
            if (correctRate < 66) {
                const retryButtonText = currentTopic === 'basic' ? 'Í∏∞Î≥∏ Í∞úÎÖê Îã§Ïãú ÌíÄÍ∏∞' : 
                                      currentTopic === 'calculation' ? 'ÏÇºÍ∞ÅÎπÑ Í≥ÑÏÇ∞ Îã§Ïãú ÌíÄÍ∏∞' :
                                      currentTopic === 'special' ? 'ÌäπÏàòÍ∞Å Îã§Ïãú ÌíÄÍ∏∞' :
                                      currentTopic === 'application' ? 'ÌôúÏö© Î¨∏Ï†ú Îã§Ïãú ÌíÄÍ∏∞' :
                                      'Ï¢ÖÌï© Î¨∏Ï†ú Îã§Ïãú ÌíÄÍ∏∞';
                
                document.getElementById('problemCard').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h2 style="color: #e74c3c; margin-bottom: 20px;">üîÑ Ïû¨ÎèÑÏ†ÑÏù¥ ÌïÑÏöîÌï¥Ïöî!</h2>
                        <p style="font-size: 1.2em; margin-bottom: 20px;">
                            ÌòÑÏû¨ Ï†ïÎãµÎ•†: <strong style="color: #e74c3c;">${correctRate}%</strong>
                        </p>
                        <p style="font-size: 1.1em; margin-bottom: 30px; line-height: 1.6;">
                            Ïù¥ Ï£ºÏ†úÎäî 66% Ïù¥ÏÉÅÏùò Ï†ïÎãµÎ•†Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.<br>
                            Îçî ÌÉÑÌÉÑÌïú Ïù¥Ìï¥Î•º ÏúÑÌï¥ Îã§Ïãú ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî! üí™<br>
                            Î∞òÎ≥µ ÌïôÏäµÏúºÎ°ú Îçî Ï¢ãÏùÄ Í≤∞Í≥ºÎ•º ÏñªÏùÑ Ïàò ÏûàÏñ¥Ïöî!
                        </p>
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button class="btn btn-primary" onclick="retryCurrentTopic()">${retryButtonText}</button>
                            <button class="btn btn-secondary" onclick="goToWelcome()">Ï£ºÏ†ú ÏÑ†ÌÉùÌïòÍ∏∞</button>
                        </div>
                    </div>
                `;
            } else {
                // 66% Ïù¥ÏÉÅ Îã¨ÏÑ± Ïãú Îã§Ïùå Ï£ºÏ†ú Ï∂îÏ≤ú
                let nextTopicButtons = '';
                let congratsMessage = '';
                
                // Î™®Îì† Ï£ºÏ†ú ÏôÑÎ£å ÌôïÏù∏
                const allTopicsCompleted = checkAllTopicsCompleted();
                
                if (currentTopic === 'mixed' && allTopicsCompleted && correctRate >= 66) {
                    // Î™®Îì† Ï£ºÏ†ú ÏôÑÎ£å + Ï¢ÖÌï©Î¨∏Ï†úÍπåÏßÄ ÏôÑÎ£å = 100% Îã¨ÏÑ±!
                    document.getElementById('problemCard').innerHTML = `
                        <div style="text-align: center; padding: 40px;">
                            <h1 style="color: #27ae60; margin-bottom: 20px; font-size: 3em;">üèÜ</h1>
                            <h2 style="color: #27ae60; margin-bottom: 20px;">ÏÇºÍ∞ÅÎπÑ ÎßàÏä§ÌÑ∞ Îã¨ÏÑ±!</h2>
                            <p style="font-size: 1.3em; margin-bottom: 20px; color: #27ae60; font-weight: bold;">
                                üéâ 100% ÏôÑÏ†Ñ Ï†ïÎ≥µ! üéâ
                            </p>
                            <p style="font-size: 1.1em; margin-bottom: 30px; line-height: 1.6;">
                                Î™®Îì† Ï£ºÏ†úÎ•º ÏôÑÎ£åÌïòÍ≥† Ï¢ÖÌï©Î¨∏Ï†úÍπåÏßÄ ÏÑ±Í≥µÌñàÏäµÎãàÎã§!<br>
                                ÎãπÏã†ÏùÄ ÏßÑÏ†ïÌïú <strong>ÏÇºÍ∞ÅÎπÑ ÎßàÏä§ÌÑ∞</strong>ÏûÖÎãàÎã§! üëë
                            </p>
                            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; margin: 20px 0;">
                                <h3 style="margin-bottom: 15px;">üè´ 3ÌïôÎÖÑ 6Î∞ò ÌïôÏÉùÎì§</h3>
                                <p style="margin-bottom: 15px;">100% Îã¨ÏÑ± Ïù∏Ï¶ùÏÉ∑ÏùÑ ÏóÖÎ°úÎìúÌï¥Ï£ºÏÑ∏Ïöî!</p>
                            </div>
                            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                                <button class="btn btn-primary" onclick="captureAndUpload()" style="background: linear-gradient(135deg, #27ae60, #2ecc71); font-size: 1.1em; padding: 15px 25px;">
                                    üì∏ Ïù∏Ï¶ùÏÉ∑ Ï∫°Ï≤ò & ÏóÖÎ°úÎìú
                                </button>
                                <button class="btn btn-secondary" onclick="resetProgress()">ÏÉàÎ°úÏö¥ ÎèÑÏ†Ñ ÏãúÏûë</button>
                                <button class="btn btn-secondary" onclick="goToWelcome()">Ï£ºÏ†ú ÏÑ†ÌÉùÌïòÍ∏∞</button>
                            </div>
                        </div>
                    `;
                    return;
                }
                
                switch(currentTopic) {
                    case 'basic':
                        congratsMessage = 'Í∏∞Î≥∏ Í∞úÎÖêÏùÑ ÏôÑÎ£åÌñàÏäµÎãàÎã§! Ïù¥Ï†ú Îã§Ïùå Îã®Í≥ÑÎ°ú ÎÑòÏñ¥Í∞à Ï§ÄÎπÑÍ∞Ä ÎêòÏóàÏñ¥Ïöî!';
                        nextTopicButtons = `
                            <button class="btn btn-primary" onclick="goToCalculation()">ÏÇºÍ∞ÅÎπÑ Í≥ÑÏÇ∞</button>
                            <button class="btn btn-primary" onclick="goToSpecial()">ÌäπÏàòÍ∞Å</button>
                        `;
                        break;
                    case 'calculation':
                        congratsMessage = 'ÏÇºÍ∞ÅÎπÑ Í≥ÑÏÇ∞ÏùÑ ÏôÑÎ£åÌñàÏäµÎãàÎã§! Îã§Î•∏ ÏòÅÏó≠ÎèÑ ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!';
                        nextTopicButtons = `
                            <button class="btn btn-primary" onclick="goToSpecial()">ÌäπÏàòÍ∞Å</button>
                            <button class="btn btn-primary" onclick="goToApplication()">ÌôúÏö© Î¨∏Ï†ú</button>
                        `;
                        break;
                    case 'special':
                        congratsMessage = 'ÌäπÏàòÍ∞ÅÏùÑ ÏôÑÎ£åÌñàÏäµÎãàÎã§! Ïã§ÏÉùÌôú ÏùëÏö© Î¨∏Ï†úÏóê ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!';
                        nextTopicButtons = `
                            <button class="btn btn-primary" onclick="goToApplication()">ÌôúÏö© Î¨∏Ï†ú</button>
                            <button class="btn btn-primary" onclick="goToMixed()">Ï¢ÖÌï© Î¨∏Ï†ú</button>
                        `;
                        break;
                    case 'application':
                        congratsMessage = 'ÌôúÏö© Î¨∏Ï†úÎ•º ÏôÑÎ£åÌñàÏäµÎãàÎã§! ÎßàÏßÄÎßâ Îã®Í≥ÑÏóê ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!';
                        nextTopicButtons = `
                            <button class="btn btn-primary" onclick="goToMixed()">Ï¢ÖÌï© Î¨∏Ï†ú</button>
                        `;
                        break;
                    case 'mixed':
                        congratsMessage = 'Ï¢ÖÌï© Î¨∏Ï†úÎ•º ÏôÑÎ£åÌñàÏäµÎãàÎã§! Îã§Î•∏ Ï£ºÏ†úÎì§ÎèÑ ÏôÑÎ£åÌï¥ÏÑú 100%Î•º Îã¨ÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî!';
                        nextTopicButtons = '';
                        break;
                }
                
                document.getElementById('problemCard').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h2 style="color: #27ae60; margin-bottom: 20px;">üéâ Ï£ºÏ†ú ÏôÑÎ£å!</h2>
                        <p style="font-size: 1.2em; margin-bottom: 20px;">
                            ÌòÑÏû¨ Ï†ïÎãµÎ•†: <strong style="color: #27ae60;">${correctRate}%</strong>
                        </p>
                        <p style="font-size: 1.1em; margin-bottom: 30px; line-height: 1.6;">
                            ${congratsMessage}
                        </p>
                        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                            ${nextTopicButtons}
                            <button class="btn btn-secondary" onclick="goToWelcome()">Ï£ºÏ†ú ÏÑ†ÌÉùÌïòÍ∏∞</button>
                        </div>
                    </div>
                `;
            }
            
            const completedItem = document.querySelector(`[data-topic="${currentTopic}"]`);
            if (completedItem && correctRate >= 66) {
                completedItem.classList.add('completed');
            }
        }

        // Î™®Îì† Ï£ºÏ†ú ÏôÑÎ£å ÌôïÏù∏
        function checkAllTopicsCompleted() {
            const topics = ['basic', 'calculation', 'special', 'application', 'mixed'];
            return topics.every(topic => {
                const topicItem = document.querySelector(`[data-topic="${topic}"]`);
                return topicItem && topicItem.classList.contains('completed');
            });
        }

        // Í∞Å Ï£ºÏ†úÎ°ú Ïù¥ÎèôÌïòÎäî Í∞úÎ≥Ñ Ìï®ÏàòÎì§
        function goToCalculation() {
            console.log('goToCalculation Ìò∏Ï∂úÎê®'); // ÎîîÎ≤ÑÍ∑∏Ïö©
            selectTopic('calculation');
        }

        function goToSpecial() {
            console.log('goToSpecial Ìò∏Ï∂úÎê®'); // ÎîîÎ≤ÑÍ∑∏Ïö©
            selectTopic('special');
        }

        function goToApplication() {
            console.log('goToApplication Ìò∏Ï∂úÎê®'); // ÎîîÎ≤ÑÍ∑∏Ïö©
            selectTopic('application');
        }

        function goToMixed() {
            console.log('goToMixed Ìò∏Ï∂úÎê®'); // ÎîîÎ≤ÑÍ∑∏Ïö©
            selectTopic('mixed');
        }

        // ÌòÑÏû¨ Ï£ºÏ†ú Ïû¨ÎèÑÏ†Ñ Ìï®Ïàò
        function retryCurrentTopic() {
            console.log('retryCurrentTopic Ïã§Ìñâ, currentTopic:', currentTopic); // ÎîîÎ≤ÑÍ∑∏Ïö©
            
            // ÌÜµÍ≥Ñ Ï¥àÍ∏∞Ìôî
            stats.totalSolved = 0;
            stats.correctAnswers = 0;
            stats.currentStreak = 0;
            
            // Î¨∏Ï†úÎ•º Î≥ÄÌòïÌïòÏó¨ ÏÉàÎ°úÏö¥ Î≤ÑÏ†ÑÏúºÎ°ú ÏÉùÏÑ±
            const originalProblems = problemSets[currentTopic];
            const newProblems = originalProblems.map((problem, index) => {
                return generateProblem(problem, Math.floor(Math.random() * 3) + 1);
            });
            
            // Î≥ÄÌòïÎêú Î¨∏Ï†úÎ°ú ÍµêÏ≤¥
            problemSets[currentTopic] = newProblems;
            
            // ÌòÑÏû¨ Ï£ºÏ†ú Îã§Ïãú ÏãúÏûë
            currentProblemIndex = 0;
            
            // Î™®Îì† Ï£ºÏ†ú Ìï≠Î™©ÏóêÏÑú active ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelectorAll('.topic-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ÌòÑÏû¨ Ï£ºÏ†ú Ìï≠Î™©ÏùÑ ÌôúÏÑ±Ìôî
            const currentItem = document.querySelector(`[data-topic="${currentTopic}"]`);
            if (currentItem) {
                currentItem.classList.remove('completed');
                currentItem.classList.add('active');
            }
            
            // ÌôòÏòÅ ÌôîÎ©¥ Ïà®Í∏∞Í≥† Î¨∏Ï†ú Ïπ¥Îìú ÌëúÏãú
            const welcomeScreen = document.getElementById('welcomeScreen');
            const problemCard = document.getElementById('problemCard');
            
            if (welcomeScreen) welcomeScreen.style.display = 'none';
            if (problemCard) {
                problemCard.style.display = 'block';
                // Í∏∞Ï°¥ ÏôÑÎ£å Î©îÏãúÏßÄ ÎÇ¥Ïö©ÏùÑ Ï¥àÍ∏∞Ìôî
                problemCard.innerHTML = `
                    <h3 class="problem-title" id="problemTitle">Î¨∏Ï†ú</h3>
                    <div class="problem-image" id="problemImage"></div>
                    <div class="problem-text" id="problemText">Î¨∏Ï†ú ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</div>
                    <div class="options" id="optionsContainer"></div>
                    <div class="buttons">
                        <button class="btn btn-secondary" id="hintBtn">üí° ÌûåÌä∏</button>
                        <button class="btn btn-primary" id="checkBtn" disabled>Ï†ïÎãµ ÌôïÏù∏</button>
                        <button class="btn btn-primary" id="nextBtn" style="display: none;">Îã§Ïùå Î¨∏Ï†ú</button>
                    </div>
                    <div class="feedback" id="feedback">
                        <div id="feedbackText"></div>
                        <div class="explanation" id="explanation"></div>
                    </div>
                `;
                
                // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îã§Ïãú Ïó∞Í≤∞
                const hintBtn = document.getElementById('hintBtn');
                const checkBtn = document.getElementById('checkBtn');
                const nextBtn = document.getElementById('nextBtn');
                
                if (hintBtn) hintBtn.addEventListener('click', showHint);
                if (checkBtn) checkBtn.addEventListener('click', checkAnswer);
                if (nextBtn) nextBtn.addEventListener('click', nextProblem);
            }
            
            // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
            updateStats();
            
            // Ï≤´ Î¨∏Ï†ú ÌëúÏãú
            showProblem();
        }

        // ÌôòÏòÅ ÌôîÎ©¥ÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
        function goToWelcome() {
            document.getElementById('problemCard').style.display = 'none';
            document.getElementById('welcomeScreen').style.display = 'block';
            document.querySelectorAll('.topic-item').forEach(item => {
                item.classList.remove('active');
            });
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
        document.addEventListener('DOMContentLoaded', function() {
            // Ï†ÄÏû•Îêú ÏßÑÌñâÏÉÅÌô© Î°úÎìú
            const hasProgress = loadProgress();
            
            // Ï£ºÏ†ú Ìï≠Î™© ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            document.querySelectorAll('.topic-item').forEach(item => {
                item.addEventListener('click', function() {
                    const topic = this.getAttribute('data-topic');
                    selectTopic(topic);
                });
            });

            // ÏãúÏûë Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            document.querySelector('.start-btn').addEventListener('click', function() {
                const topic = this.getAttribute('data-topic');
                selectTopic(topic);
            });

            // ÌûåÌä∏ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            const hintBtn = document.getElementById('hintBtn');
            if (hintBtn) hintBtn.addEventListener('click', showHint);

            // Ï†ïÎãµ ÌôïÏù∏ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            const checkBtn = document.getElementById('checkBtn');
            if (checkBtn) checkBtn.addEventListener('click', checkAnswer);

            // Îã§Ïùå Î¨∏Ï†ú Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) nextBtn.addEventListener('click', nextProblem);

            // Ï¥àÍ∏∞ ÌÜµÍ≥Ñ ÌëúÏãú
            updateStats();
            
            // ÏßÑÌñâÏÉÅÌô©Ïù¥ ÏûàÍ≥† ÌòÑÏû¨ Ï£ºÏ†úÍ∞Ä ÏÑ§Ï†ïÎêòÏñ¥ ÏûàÎã§Î©¥ Î≥µÏõê
            if (hasProgress && currentTopic) {
                const activeItem = document.querySelector(`[data-topic="${currentTopic}"]`);
                if (activeItem) {
                    activeItem.classList.add('active');
                }
                
                // ÏßÑÌñâÏ§ëÏù∏ Ï£ºÏ†úÍ∞Ä ÏûàÏúºÎ©¥ Î¨∏Ï†ú ÌôîÎ©¥ÏúºÎ°ú
                if (currentTopic && currentProblemIndex >= 0) {
                    const welcomeScreen = document.getElementById('welcomeScreen');
                    const problemCard = document.getElementById('problemCard');
                    
                    if (welcomeScreen) welcomeScreen.style.display = 'none';
                    if (problemCard) problemCard.style.display = 'block';
                    
                    // Í∏∞Î≥∏ Íµ¨Ï°∞ ÏÑ§Ï†ï
                    problemCard.innerHTML = `
                        <h3 class="problem-title" id="problemTitle">Î¨∏Ï†ú</h3>
                        <div class="problem-image" id="problemImage"></div>
                        <div class="problem-text" id="problemText">Î¨∏Ï†ú ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</div>
                        <div class="options" id="optionsContainer"></div>
                        <div class="buttons">
                            <button class="btn btn-secondary" id="hintBtn">üí° ÌûåÌä∏</button>
                            <button class="btn btn-primary" id="checkBtn" disabled>Ï†ïÎãµ ÌôïÏù∏</button>
                            <button class="btn btn-primary" id="nextBtn" style="display: none;">Îã§Ïùå Î¨∏Ï†ú</button>
                        </div>
                        <div class="feedback" id="feedback">
                            <div id="feedbackText"></div>
                            <div class="explanation" id="explanation"></div>
                        </div>
                    `;
                    
                    // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ïû¨Ïó∞Í≤∞
                    const hintBtn = document.getElementById('hintBtn');
                    const checkBtn = document.getElementById('checkBtn');
                    const nextBtn = document.getElementById('nextBtn');
                    
                    if (hintBtn) hintBtn.addEventListener('click', showHint);
                    if (checkBtn) checkBtn.addEventListener('click', checkAnswer);
                    if (nextBtn) nextBtn.addEventListener('click', nextProblem);
                    
                    showProblem();
                }
            }
        });
    </script>
</body>
</html>
